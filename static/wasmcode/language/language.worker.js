var Ha=Object.create;var Vr=Object.defineProperty;var Ya=Object.getOwnPropertyDescriptor;var Ua=Object.getOwnPropertyNames;var Ga=Object.getPrototypeOf,Xa=Object.prototype.hasOwnProperty;var Ja=(h,v)=>()=>(v||h((v={exports:{}}).exports,v),v.exports);var Za=(h,v,b,C)=>{if(v&&typeof v=="object"||typeof v=="function")for(let D of Ua(v))!Xa.call(h,D)&&D!==b&&Vr(h,D,{get:()=>v[D],enumerable:!(C=Ya(v,D))||C.enumerable});return h};var qa=(h,v,b)=>(b=h!=null?Ha(Ga(h)):{},Za(v||!h||!h.__esModule?Vr(b,"default",{value:h,enumerable:!0}):b,h));var Zr=Ja(($n,Wn)=>{(function(h,v){typeof $n=="object"&&typeof Wn<"u"?Wn.exports=v():typeof define=="function"&&define.amd?define(v):(h=typeof globalThis<"u"?globalThis:h||self,h.Dexie=v())})($n,function(){"use strict";var h=function(e,t){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},h(e,t)};function v(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");h(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var b=function(){return b=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},b.apply(this,arguments)};function C(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}var D=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,N=Object.keys,j=Array.isArray;typeof Promise<"u"&&!D.Promise&&(D.Promise=Promise);function L(e,t){return typeof t!="object"||N(t).forEach(function(n){e[n]=t[n]}),e}var U=Object.getPrototypeOf,H={}.hasOwnProperty;function $(e,t){return H.call(e,t)}function Z(e,t){typeof t=="function"&&(t=t(U(e))),(typeof Reflect>"u"?N:Reflect.ownKeys)(t).forEach(function(n){te(e,n,t[n])})}var q=Object.defineProperty;function te(e,t,n,r){q(e,t,L(n&&$(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Be(e){return{from:function(t){return e.prototype=Object.create(t.prototype),te(e.prototype,"constructor",e),{extend:Z.bind(null,e.prototype)}}}}var li=Object.getOwnPropertyDescriptor;function Gn(e,t){var n=li(e,t),r;return n||(r=U(e))&&Gn(r,t)}var fi=[].slice;function ft(e,t,n){return fi.call(e,t,n)}function Xn(e,t){return t(e)}function Ye(e){if(!e)throw new Error("Assertion Failed")}function Jn(e){D.setImmediate?setImmediate(e):setTimeout(e,0)}function hi(e,t){return e.reduce(function(n,r,i){var a=t(r,i);return a&&(n[a[0]]=a[1]),n},{})}function fe(e,t){if(typeof t=="string"&&$(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,i=t.length;r<i;++r){var a=fe(e,t[r]);n.push(a)}return n}var o=t.indexOf(".");if(o!==-1){var u=e[t.substr(0,o)];return u==null?void 0:fe(u,t.substr(o+1))}}function ne(e,t,n){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Ye(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)ne(e,t[r],n[r])}else{var a=t.indexOf(".");if(a!==-1){var o=t.substr(0,a),u=t.substr(a+1);if(u==="")n===void 0?j(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n;else{var s=e[o];(!s||!$(e,o))&&(s=e[o]={}),ne(s,u,n)}}else n===void 0?j(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function di(e,t){typeof t=="string"?ne(e,t,void 0):"length"in t&&[].map.call(t,function(n){ne(e,n,void 0)})}function Zn(e){var t={};for(var n in e)$(e,n)&&(t[n]=e[n]);return t}var pi=[].concat;function qn(e){return pi.apply([],e)}var vi="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(qn([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return D[e]}),er=new Set(vi.map(function(e){return D[e]}));function tr(e){var t={};for(var n in e)if($(e,n)){var r=e[n];t[n]=!r||typeof r!="object"||er.has(r.constructor)?r:tr(r)}return t}function yi(e){for(var t in e)if($(e,t))return!1;return!0}var Ue=null;function Ie(e){Ue=new WeakMap;var t=Ut(e);return Ue=null,t}function Ut(e){if(!e||typeof e!="object")return e;var t=Ue.get(e);if(t)return t;if(j(e)){t=[],Ue.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(Ut(e[n]))}else if(er.has(e.constructor))t=e;else{var i=U(e);t=i===Object.prototype?{}:Object.create(i),Ue.set(e,t);for(var a in e)$(e,a)&&(t[a]=Ut(e[a]))}return t}var mi={}.toString;function Gt(e){return mi.call(e).slice(8,-1)}var Xt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",gi=typeof Xt=="symbol"?function(e){var t;return e!=null&&(t=e[Xt])&&t.apply(e)}:function(){return null};function Se(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n>=0}var Fe={};function he(e){var t,n,r,i;if(arguments.length===1){if(j(e))return e.slice();if(this===Fe&&typeof e=="string")return[e];if(i=gi(e)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var Jt=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},bi=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],nr=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Zt=bi.concat(nr),wi={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function je(e,t){this.name=e,this.message=t}Be(je).from(Error).extend({toString:function(){return this.name+": "+this.message}});function rr(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function ht(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=rr(e,t)}Be(ht).from(je);function Ne(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=rr(e,this.failures)}Be(Ne).from(je);var qt=Zt.reduce(function(e,t){return e[t]=t+"Error",e},{}),xi=je,K=Zt.reduce(function(e,t){var n=t+"Error";function r(i,a){this.name=n,i?typeof i=="string"?(this.message="".concat(i).concat(a?`
 `+a:""),this.inner=a||null):typeof i=="object"&&(this.message="".concat(i.name," ").concat(i.message),this.inner=i):(this.message=wi[t]||n,this.inner=null)}return Be(r).from(xi),e[t]=r,e},{});K.Syntax=SyntaxError,K.Type=TypeError,K.Range=RangeError;var ir=nr.reduce(function(e,t){return e[t+"Error"]=K[t],e},{});function _i(e,t){if(!e||e instanceof je||e instanceof TypeError||e instanceof SyntaxError||!e.name||!ir[e.name])return e;var n=new ir[e.name](t||e.message,e);return"stack"in e&&te(n,"stack",{get:function(){return this.inner.stack}}),n}var dt=Zt.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=K[t]),e},{});dt.ModifyError=ht,dt.DexieError=je,dt.BulkError=Ne;function W(){}function Ge(e){return e}function ki(e,t){return e==null||e===Ge?t:function(n){return t(e(n))}}function Pe(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Ei(e,t){return e===W?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Pe(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Pe(i,this.onerror):i),a!==void 0?a:n}}function Ii(e,t){return e===W?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Pe(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Pe(r,this.onerror):r)}}function Si(e,t){return e===W?t:function(n){var r=e.apply(this,arguments);L(n,r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Pe(i,this.onsuccess):i),a&&(this.onerror=this.onerror?Pe(a,this.onerror):a),r===void 0?o===void 0?void 0:o:L(r,o)}}function Pi(e,t){return e===W?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function en(e,t){return e===W?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then(function(){return t.apply(r,a)})}return t.apply(this,arguments)}}var ue=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ar(e,t){ue=e}var Xe={},or=100,tn=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,U(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,U(t),e]}(),ur=tn[0],sr=tn[1],Ci=tn[2],Ti=sr&&sr.then,Je=ur&&ur.constructor,nn=!!Ci;function Ai(){queueMicrotask(Oi)}var Ze=function(e,t){qe.push([e,t]),pt&&(Ai(),pt=!1)},rn=!0,pt=!0,Ce=[],vt=[],an=Ge,ve={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:W,pgp:!1,env:{},finalize:W},O=ve,qe=[],Te=0,yt=[];function S(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=O;if(typeof e!="function"){if(e!==Xe)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&un(this,this._value);return}this._state=null,this._value=null,++t.ref,lr(this,e)}var on={get:function(){var e=O,t=wt;function n(r,i){var a=this,o=!e.global&&(e!==O||t!==wt),u=o&&!me(),s=new S(function(c,d){sn(a,new cr(dr(r,e,o,u),dr(i,e,o,u),c,d,e))});return this._consoleTask&&(s._consoleTask=this._consoleTask),s}return n.prototype=Xe,n},set:function(e){te(this,"then",e&&e.prototype===Xe?on:{get:function(){return e},set:on.set})}};Z(S.prototype,{then:on,_then:function(e,t){sn(this,new cr(null,null,e,t,O))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],n=arguments[1];return typeof t=="function"?this.then(null,function(r){return r instanceof t?n(r):mt(r)}):this.then(null,function(r){return r&&r.name===t?n(r):mt(r)})},finally:function(e){return this.then(function(t){return S.resolve(e()).then(function(){return t})},function(t){return S.resolve(e()).then(function(){return mt(t)})})},timeout:function(e,t){var n=this;return e<1/0?new S(function(r,i){var a=setTimeout(function(){return i(new K.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&te(S.prototype,Symbol.toStringTag,"Dexie.Promise"),ve.env=hr();function cr(e,t,n,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=i}Z(S,{all:function(){var e=he.apply(null,arguments).map(xt);return new S(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,a){return S.resolve(i).then(function(o){e[a]=o,--r||t(e)},n)})})},resolve:function(e){if(e instanceof S)return e;if(e&&typeof e.then=="function")return new S(function(n,r){e.then(n,r)});var t=new S(Xe,!0,e);return t},reject:mt,race:function(){var e=he.apply(null,arguments).map(xt);return new S(function(t,n){e.map(function(r){return S.resolve(r).then(t,n)})})},PSD:{get:function(){return O},set:function(e){return O=e}},totalEchoes:{get:function(){return wt}},newPSD:ye,usePSD:Ae,scheduler:{get:function(){return Ze},set:function(e){Ze=e}},rejectionMapper:{get:function(){return an},set:function(e){an=e}},follow:function(e,t){return new S(function(n,r){return ye(function(i,a){var o=O;o.unhandleds=[],o.onunhandled=a,o.finalize=Pe(function(){var u=this;Ki(function(){u.unhandleds.length===0?i():a(u.unhandleds[0])})},o.finalize),e()},t,n,r)})}}),Je&&(Je.allSettled&&te(S,"allSettled",function(){var e=he.apply(null,arguments).map(xt);return new S(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(i,a){return S.resolve(i).then(function(o){return r[a]={status:"fulfilled",value:o}},function(o){return r[a]={status:"rejected",reason:o}}).then(function(){return--n||t(r)})})})}),Je.any&&typeof AggregateError<"u"&&te(S,"any",function(){var e=he.apply(null,arguments).map(xt);return new S(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(a,o){return S.resolve(a).then(function(u){return t(u)},function(u){i[o]=u,--r||n(new AggregateError(i))})})})}));function lr(e,t){try{t(function(n){if(e._state===null){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&Le();n&&typeof n.then=="function"?lr(e,function(i,a){n instanceof S?n._then(i,a):n.then(i,a)}):(e._state=!0,e._value=n,fr(e)),r&&Ve()}},un.bind(null,e))}catch(n){un(e,n)}}function un(e,t){if(vt.push(t),e._state===null){var n=e._lib&&Le();t=an(t),e._state=!1,e._value=t,Ri(e),fr(e),n&&Ve()}}function fr(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)sn(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),Te===0&&(++Te,Ze(function(){--Te===0&&cn()},[]))}function sn(e,t){if(e._state===null){e._listeners.push(t);return}var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Te,Ze(Di,[n,e,t])}function Di(e,t,n){try{var r,i=t._value;!t._state&&vt.length&&(vt=[]),r=ue&&t._consoleTask?t._consoleTask.run(function(){return e(i)}):e(i),!t._state&&vt.indexOf(i)===-1&&Mi(t),n.resolve(r)}catch(a){n.reject(a)}finally{--Te===0&&cn(),--n.psd.ref||n.psd.finalize()}}function Oi(){Ae(ve,function(){Le()&&Ve()})}function Le(){var e=rn;return rn=!1,pt=!1,e}function Ve(){var e,t,n;do for(;qe.length>0;)for(e=qe,qe=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(qe.length>0);rn=!0,pt=!0}function cn(){var e=Ce;Ce=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=yt.slice(0),n=t.length;n;)t[--n]()}function Ki(e){function t(){e(),yt.splice(yt.indexOf(t),1)}yt.push(t),++Te,Ze(function(){--Te===0&&cn()},[])}function Ri(e){Ce.some(function(t){return t._value===e._value})||Ce.push(e)}function Mi(e){for(var t=Ce.length;t;)if(Ce[--t]._value===e._value){Ce.splice(t,1);return}}function mt(e){return new S(Xe,!1,e)}function Y(e,t){var n=O;return function(){var r=Le(),i=O;try{return ge(n,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{ge(i,!1),r&&Ve()}}}var X={awaits:0,echoes:0,id:0},Bi=0,gt=[],bt=0,wt=0,Fi=0;function ye(e,t,n,r){var i=O,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++Fi,ve.env,a.env=nn?{Promise:S,PromiseProp:{value:S,configurable:!0,writable:!0},all:S.all,race:S.race,allSettled:S.allSettled,any:S.any,resolve:S.resolve,reject:S.reject}:{},t&&L(a,t),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=Ae(a,e,n,r);return a.ref===0&&a.finalize(),o}function ze(){return X.id||(X.id=++Bi),++X.awaits,X.echoes+=or,X.id}function me(){return X.awaits?(--X.awaits===0&&(X.id=0),X.echoes=X.awaits*or,!0):!1}(""+Ti).indexOf("[native code]")===-1&&(ze=me=W);function xt(e){return X.echoes&&e&&e.constructor===Je?(ze(),e.then(function(t){return me(),t},function(t){return me(),G(t)})):e}function ji(e){++wt,(!X.echoes||--X.echoes===0)&&(X.echoes=X.awaits=X.id=0),gt.push(O),ge(e,!0)}function Ni(){var e=gt[gt.length-1];gt.pop(),ge(e,!1)}function ge(e,t){var n=O;if((t?X.echoes&&(!bt++||e!==O):bt&&(!--bt||e!==O))&&queueMicrotask(t?ji.bind(null,e):Ni),e!==O&&(O=e,n===ve&&(ve.env=hr()),nn)){var r=ve.env.Promise,i=e.env;(n.global||e.global)&&(Object.defineProperty(D,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function hr(){var e=D.Promise;return nn?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(D,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Ae(e,t,n,r,i){var a=O;try{return ge(e,!0),t(n,r,i)}finally{ge(a,!1)}}function dr(e,t,n,r){return typeof e!="function"?e:function(){var i=O;n&&ze(),ge(t,!0);try{return e.apply(this,arguments)}finally{ge(i,!1),r&&queueMicrotask(me)}}}function ln(e){Promise===Je&&X.echoes===0?bt===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}var G=S.reject;function fn(e,t,n,r){if(!e.idbdb||!e._state.openComplete&&!O.letThrough&&!e._vip){if(e._state.openComplete)return G(new K.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return G(new K.DatabaseClosed);e.open().catch(W)}return e._state.dbReadyPromise.then(function(){return fn(e,t,n,r)})}else{var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(a){return a.name===qt.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return fn(e,t,n,r)})):G(a)}return i._promise(t,function(a,o){return ye(function(){return O.trans=i,r(a,o,i)})}).then(function(a){if(t==="readwrite")try{i.idbtrans.commit()}catch{}return t==="readonly"?a:i._completion.then(function(){return a})})}}var pr="4.0.8",De="\uFFFF",hn=-1/0,de="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",vr="String expected.",$e=[],_t="__dbnames",dn="readonly",pn="readwrite";function Oe(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var yr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function kt(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=Ie(t),delete t[e]),t}:function(t){return t}}function mr(){throw K.Type()}function z(e,t){try{var n=gr(e),r=gr(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return Vi(br(e),br(t));case"Array":return Li(e,t)}}catch{}return NaN}function Li(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a){var o=z(e[a],t[a]);if(o!==0)return o}return n===r?0:n<r?-1:1}function Vi(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a)if(e[a]!==t[a])return e[a]<t[a]?-1:1;return n===r?0:n<r?-1:1}function gr(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var n=Gt(e);return n==="ArrayBuffer"?"binary":n}function br(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var wr=function(){function e(){}return e.prototype._trans=function(t,n,r){var i=this._tx||O.trans,a=this.name,o=ue&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(t==="readonly"?"read":"write"," ").concat(this.name));function u(d,l,y){if(!y.schema[a])throw new K.NotFound("Table "+a+" not part of transaction");return n(y.idbtrans,y)}var s=Le();try{var c=i&&i.db._novip===this.db._novip?i===O.trans?i._promise(t,u,r):ye(function(){return i._promise(t,u,r)},{trans:i,transless:O.transless||O}):fn(this.db,t,[this.name],u);return o&&(c._consoleTask=o,c=c.catch(function(d){return console.trace(d),G(d)})),c}finally{s&&Ve()}},e.prototype.get=function(t,n){var r=this;return t&&t.constructor===Object?this.where(t).first(n):t==null?G(new K.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return r.core.get({trans:i,key:t}).then(function(a){return r.hook.reading.fire(a)})}).then(n)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(j(t))return new this.db.WhereClause(this,"[".concat(t.join("+"),"]"));var n=N(t);if(n.length===1)return this.where(n[0]).equals(t[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(l){if(l.compound&&n.every(function(E){return l.keyPath.indexOf(E)>=0})){for(var y=0;y<n.length;++y)if(n.indexOf(l.keyPath[y])===-1)return!1;return!0}return!1}).sort(function(l,y){return l.keyPath.length-y.keyPath.length})[0];if(r&&this.db._maxKey!==De){var i=r.keyPath.slice(0,n.length);return this.where(i).equals(i.map(function(l){return t[l]}))}!r&&ue&&console.warn("The query ".concat(JSON.stringify(t)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(n.join("+"),"]"));var a=this.schema.idxByName,o=this.db._deps.indexedDB;function u(l,y){return o.cmp(l,y)===0}var s=n.reduce(function(l,y){var E=l[0],f=l[1],p=a[y],m=t[y];return[E||p,E||!p?Oe(f,p&&p.multi?function(g){var w=fe(g,y);return j(w)&&w.some(function(_){return u(m,_)})}:function(g){return u(m,fe(g,y))}):f]},[null,null]),c=s[0],d=s[1];return c?this.where(c.name).equals(t[c.keyPath]).filter(d):r?this.filter(d):this.where(n).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,j(t)?"[".concat(t.join("+"),"]"):t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){var n=this,r=n.db,i=n.name;this.schema.mappedClass=t,t.prototype instanceof mr&&(t=function(s){v(c,s);function c(){return s!==null&&s.apply(this,arguments)||this}return Object.defineProperty(c.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),c.prototype.table=function(){return i},c}(t));for(var a=new Set,o=t.prototype;o;o=U(o))Object.getOwnPropertyNames(o).forEach(function(s){return a.add(s)});var u=function(s){if(!s)return s;var c=Object.create(t.prototype);for(var d in s)if(!a.has(d))try{c[d]=s[d]}catch{}return c};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=u,this.hook("reading",u),t},e.prototype.defineClass=function(){function t(n){L(this,n)}return this.mapToClass(t)},e.prototype.add=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,u=t;return o&&a&&(u=kt(o)(t)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"add",keys:n!=null?[n]:null,values:[u]})}).then(function(s){return s.numFailures?S.reject(s.failures[0]):s.lastResult}).then(function(s){if(o)try{ne(t,o,s)}catch{}return s})},e.prototype.update=function(t,n){if(typeof t=="object"&&!j(t)){var r=fe(t,this.schema.primKey.keyPath);return r===void 0?G(new K.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(t).modify(n)},e.prototype.put=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,u=t;return o&&a&&(u=kt(o)(t)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"put",values:[u],keys:n!=null?[n]:null})}).then(function(s){return s.numFailures?S.reject(s.failures[0]):s.lastResult}).then(function(s){if(o)try{ne(t,o,s)}catch{}return s})},e.prototype.delete=function(t){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[t]})}).then(function(r){return r.numFailures?S.reject(r.failures[0]):void 0})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"deleteRange",range:yr})}).then(function(n){return n.numFailures?S.reject(n.failures[0]):void 0})},e.prototype.bulkGet=function(t){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:t,trans:r}).then(function(i){return i.map(function(a){return n.hook.reading.fire(a)})})})},e.prototype.bulkAdd=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,c=s.auto,d=s.keyPath;if(d&&a)throw new K.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");var l=t.length,y=d&&c?t.map(kt(d)):t;return i.core.mutate({trans:u,type:"add",keys:a,values:y,wantResults:o}).then(function(E){var f=E.numFailures,p=E.results,m=E.lastResult,g=E.failures,w=o?p:m;if(f===0)return w;throw new Ne("".concat(i.name,".bulkAdd(): ").concat(f," of ").concat(l," operations failed"),g)})})},e.prototype.bulkPut=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,c=s.auto,d=s.keyPath;if(d&&a)throw new K.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");var l=t.length,y=d&&c?t.map(kt(d)):t;return i.core.mutate({trans:u,type:"put",keys:a,values:y,wantResults:o}).then(function(E){var f=E.numFailures,p=E.results,m=E.lastResult,g=E.failures,w=o?p:m;if(f===0)return w;throw new Ne("".concat(i.name,".bulkPut(): ").concat(f," of ").concat(l," operations failed"),g)})})},e.prototype.bulkUpdate=function(t){var n=this,r=this.core,i=t.map(function(u){return u.key}),a=t.map(function(u){return u.changes}),o=[];return this._trans("readwrite",function(u){return r.getMany({trans:u,keys:i,cache:"clone"}).then(function(s){var c=[],d=[];t.forEach(function(y,E){var f=y.key,p=y.changes,m=s[E];if(m){for(var g=0,w=Object.keys(p);g<w.length;g++){var _=w[g],k=p[_];if(_===n.schema.primKey.keyPath){if(z(k,f)!==0)throw new K.Constraint("Cannot update primary key in bulkUpdate()")}else ne(m,_,k)}o.push(E),c.push(f),d.push(m)}});var l=c.length;return r.mutate({trans:u,type:"put",keys:c,values:d,updates:{keys:i,changeSpecs:a}}).then(function(y){var E=y.numFailures,f=y.failures;if(E===0)return l;for(var p=0,m=Object.keys(f);p<m.length;p++){var g=m[p],w=o[Number(g)];if(w!=null){var _=f[g];delete f[g],f[w]=_}}throw new Ne("".concat(n.name,".bulkUpdate(): ").concat(E," of ").concat(l," operations failed"),f)})})})},e.prototype.bulkDelete=function(t){var n=this,r=t.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:t})}).then(function(i){var a=i.numFailures,o=i.lastResult,u=i.failures;if(a===0)return o;throw new Ne("".concat(n.name,".bulkDelete(): ").concat(a," of ").concat(r," operations failed"),u)})},e}();function et(e){var t={},n=function(u,s){if(s){for(var c=arguments.length,d=new Array(c-1);--c;)d[c-1]=arguments[c];return t[u].subscribe.apply(null,d),e}else if(typeof u=="string")return t[u]};n.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return n;function a(u,s,c){if(typeof u=="object")return o(u);s||(s=Pi),c||(c=W);var d={subscribers:[],fire:c,subscribe:function(l){d.subscribers.indexOf(l)===-1&&(d.subscribers.push(l),d.fire=s(d.fire,l))},unsubscribe:function(l){d.subscribers=d.subscribers.filter(function(y){return y!==l}),d.fire=d.subscribers.reduce(s,c)}};return t[u]=n[u]=d,d}function o(u){N(u).forEach(function(s){var c=u[s];if(j(c))a(s,u[s][0],u[s][1]);else if(c==="asap")var d=a(s,Ge,function(){for(var y=arguments.length,E=new Array(y);y--;)E[y]=arguments[y];d.subscribers.forEach(function(f){Jn(function(){f.apply(null,E)})})});else throw new K.InvalidArgument("Invalid event config")})}}function tt(e,t){return Be(t).from({prototype:e}),t}function zi(e){return tt(wr.prototype,function(n,r,i){this.db=e,this._tx=i,this.name=n,this.schema=r,this.hook=e._allTables[n]?e._allTables[n].hook:et(null,{creating:[Ei,W],reading:[ki,Ge],updating:[Si,W],deleting:[Ii,W]})})}function We(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function vn(e,t){e.filter=Oe(e.filter,t)}function yn(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Oe(r(),t())}:t,e.justLimit=n&&!r}function $i(e,t){e.isMatch=Oe(e.isMatch,t)}function Et(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new K.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function xr(e,t,n){var r=Et(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function It(e,t,n,r){var i=e.replayFilter?Oe(e.filter,e.replayFilter()):e.filter;if(e.or){var a={},o=function(u,s,c){if(!i||i(s,c,function(y){return s.stop(y)},function(y){return s.fail(y)})){var d=s.primaryKey,l=""+d;l==="[object ArrayBuffer]"&&(l=""+new Uint8Array(d)),$(a,l)||(a[l]=!0,t(u,s,c))}};return Promise.all([e.or._iterate(o,n),_r(xr(e,r,n),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}else return _r(xr(e,r,n),Oe(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function _r(e,t,n,r){var i=r?function(o,u,s){return n(r(o),u,s)}:n,a=Y(i);return e.then(function(o){if(o)return o.start(function(){var u=function(){return o.continue()};(!t||t(o,function(s){return u=s},function(s){o.stop(s),u=W},function(s){o.fail(s),u=W}))&&a(o.value,o,function(s){return u=s}),u()})})}var Wi=Symbol(),nt=function(){function e(t){Object.assign(this,t)}return e.prototype.execute=function(t){var n;if(this.add!==void 0){var r=this.add;if(j(r))return C(C([],j(t)?t:[],!0),r,!0).sort();if(typeof r=="number")return(Number(t)||0)+r;if(typeof r=="bigint")try{return BigInt(t)+r}catch{return BigInt(0)+r}throw new TypeError("Invalid term ".concat(r))}if(this.remove!==void 0){var i=this.remove;if(j(i))return j(t)?t.filter(function(o){return!i.includes(o)}).sort():[];if(typeof i=="number")return Number(t)-i;if(typeof i=="bigint")try{return BigInt(t)-i}catch{return BigInt(0)-i}throw new TypeError("Invalid subtrahend ".concat(i))}var a=(n=this.replacePrefix)===null||n===void 0?void 0:n[0];return a&&typeof t=="string"&&t.startsWith(a)?this.replacePrefix[1]+t.substring(a.length):t},e}(),Qi=function(){function e(){}return e.prototype._read=function(t,n){var r=this._ctx;return r.error?r.table._trans(null,G.bind(null,r.error)):r.table._trans("readonly",t).then(n)},e.prototype._write=function(t){var n=this._ctx;return n.error?n.table._trans(null,G.bind(null,n.error)):n.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var n=this._ctx;n.algorithm=Oe(n.algorithm,t)},e.prototype._iterate=function(t,n){return It(this._ctx,t,n,this._ctx.table.core)},e.prototype.clone=function(t){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&L(r,t),n._ctx=r,n},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var n=this._ctx;return this._read(function(r){return It(n,t,r,n.table.core)})},e.prototype.count=function(t){var n=this;return this._read(function(r){var i=n._ctx,a=i.table.core;if(We(i,!0))return a.count({trans:r,query:{index:Et(i,a.schema),range:i.range}}).then(function(u){return Math.min(u,i.limit)});var o=0;return It(i,function(){return++o,!1},r,a).then(function(){return o})}).then(t)},e.prototype.sortBy=function(t,n){var r=t.split(".").reverse(),i=r[0],a=r.length-1;function o(c,d){return d?o(c[r[d]],d-1):c[i]}var u=this._ctx.dir==="next"?1:-1;function s(c,d){var l=o(c,a),y=o(d,a);return l<y?-u:l>y?u:0}return this.toArray(function(c){return c.sort(s)}).then(n)},e.prototype.toArray=function(t){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&We(i,!0)&&i.limit>0){var a=i.valueMapper,o=Et(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:o,range:i.range}}).then(function(s){var c=s.result;return a?c.map(a):c})}else{var u=[];return It(i,function(s){return u.push(s)},r,i.table.core).then(function(){return u})}},t)},e.prototype.offset=function(t){var n=this._ctx;return t<=0?this:(n.offset+=t,We(n)?yn(n,function(){var r=t;return function(i,a){return r===0?!0:r===1?(--r,!1):(a(function(){i.advance(r),r=0}),!1)}}):yn(n,function(){var r=t;return function(){return--r<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),yn(this._ctx,function(){var n=t;return function(r,i,a){return--n<=0&&i(a),n>=0}},!0),this},e.prototype.until=function(t,n){return vn(this._ctx,function(r,i,a){return t(r.value)?(i(a),n):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(n){return n[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return vn(this._ctx,function(n){return t(n.value)}),$i(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.key,i)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.primaryKey,i)})},e.prototype.keys=function(t){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.key)}).then(function(){return r}).then(t)},e.prototype.primaryKeys=function(t){var n=this._ctx;if(n.dir==="next"&&We(n,!0)&&n.limit>0)return this._read(function(i){var a=Et(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:a,range:n.range}})}).then(function(i){var a=i.result;return a}).then(t);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.primaryKey)}).then(function(){return r}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(n){return n[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var r={};return vn(this._ctx,function(i){var a=i.primaryKey.toString(),o=$(r,a);return r[a]=!0,!o}),this},e.prototype.modify=function(t){var n=this,r=this._ctx;return this._write(function(i){var a;if(typeof t=="function")a=t;else{var o=N(t),u=o.length;a=function(g){for(var w=!1,_=0;_<u;++_){var k=o[_],x=t[k],I=fe(g,k);x instanceof nt?(ne(g,k,x.execute(I)),w=!0):I!==x&&(ne(g,k,x),w=!0)}return w}}var s=r.table.core,c=s.schema.primaryKey,d=c.outbound,l=c.extractKey,y=n.db._options.modifyChunkSize||200,E=[],f=0,p=[],m=function(g,w){var _=w.failures,k=w.numFailures;f+=g-k;for(var x=0,I=N(_);x<I.length;x++){var P=I[x];E.push(_[P])}};return n.clone().primaryKeys().then(function(g){var w=We(r)&&r.limit===1/0&&(typeof t!="function"||t===mn)&&{index:r.index,range:r.range},_=function(k){var x=Math.min(y,g.length-k);return s.getMany({trans:i,keys:g.slice(k,k+x),cache:"immutable"}).then(function(I){for(var P=[],T=[],B=d?[]:null,A=[],R=0;R<x;++R){var V=I[R],F={value:Ie(V),primKey:g[k+R]};a.call(F,F.value,F)!==!1&&(F.value==null?A.push(g[k+R]):!d&&z(l(V),l(F.value))!==0?(A.push(g[k+R]),P.push(F.value)):(T.push(F.value),d&&B.push(g[k+R])))}return Promise.resolve(P.length>0&&s.mutate({trans:i,type:"add",values:P}).then(function(Q){for(var M in Q.failures)A.splice(parseInt(M),1);m(P.length,Q)})).then(function(){return(T.length>0||w&&typeof t=="object")&&s.mutate({trans:i,type:"put",keys:B,values:T,criteria:w,changeSpec:typeof t!="function"&&t,isAdditionalChunk:k>0}).then(function(Q){return m(T.length,Q)})}).then(function(){return(A.length>0||w&&t===mn)&&s.mutate({trans:i,type:"delete",keys:A,criteria:w,isAdditionalChunk:k>0}).then(function(Q){return m(A.length,Q)})}).then(function(){return g.length>k+x&&_(k+y)})})};return _(0).then(function(){if(E.length>0)throw new ht("Error modifying one or more objects",E,f,p);return g.length})})})},e.prototype.delete=function(){var t=this._ctx,n=t.range;return We(t)&&(t.isPrimKey||n.type===3)?this._write(function(r){var i=t.table.core.schema.primaryKey,a=n;return t.table.core.count({trans:r,query:{index:i,range:a}}).then(function(o){return t.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(function(u){var s=u.failures;u.lastResult,u.results;var c=u.numFailures;if(c)throw new ht("Could not delete some values",Object.keys(s).map(function(d){return s[d]}),o-c);return o-c})})}):this.modify(mn)},e}(),mn=function(e,t){return t.value=null};function Hi(e){return tt(Qi.prototype,function(n,r){this.db=e;var i=yr,a=null;if(r)try{i=r()}catch(c){a=c}var o=n._ctx,u=o.table,s=u.hook.reading.fire;this._ctx={table:u,index:o.index,isPrimKey:!o.index||u.schema.primKey.keyPath&&o.index===u.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:a,or:o.or,valueMapper:s!==Ge?s:null}})}function Yi(e,t){return e<t?-1:e===t?0:1}function Ui(e,t){return e>t?-1:e===t?0:1}function re(e,t,n){var r=e instanceof Er?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Qe(e){return new e.Collection(e,function(){return kr("")}).limit(0)}function Gi(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function Xi(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function Ji(e,t,n,r,i,a){for(var o=Math.min(e.length,r.length),u=-1,s=0;s<o;++s){var c=t[s];if(c!==r[s])return i(e[s],n[s])<0?e.substr(0,s)+n[s]+n.substr(s+1):i(e[s],r[s])<0?e.substr(0,s)+r[s]+n.substr(s+1):u>=0?e.substr(0,u)+t[u]+n.substr(u+1):null;i(e[s],c)<0&&(u=s)}return o<r.length&&a==="next"?e+n.substr(e.length):o<e.length&&a==="prev"?e.substr(0,n.length):u<0?null:e.substr(0,u)+r[u]+n.substr(u+1)}function St(e,t,n,r){var i,a,o,u,s,c,d,l=n.length;if(!n.every(function(p){return typeof p=="string"}))return re(e,vr);function y(p){i=Gi(p),a=Xi(p),o=p==="next"?Yi:Ui;var m=n.map(function(g){return{lower:a(g),upper:i(g)}}).sort(function(g,w){return o(g.lower,w.lower)});u=m.map(function(g){return g.upper}),s=m.map(function(g){return g.lower}),c=p,d=p==="next"?"":r}y("next");var E=new e.Collection(e,function(){return be(u[0],s[l-1]+r)});E._ondirectionchange=function(p){y(p)};var f=0;return E._addAlgorithm(function(p,m,g){var w=p.key;if(typeof w!="string")return!1;var _=a(w);if(t(_,s,f))return!0;for(var k=null,x=f;x<l;++x){var I=Ji(w,_,u[x],s[x],o,c);I===null&&k===null?f=x+1:(k===null||o(k,I)>0)&&(k=I)}return m(k!==null?function(){p.continue(k+d)}:g),!1}),E}function be(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function kr(e){return{type:1,lower:e,upper:e}}var Er=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(t,n)>0||this._cmp(t,n)===0&&(r||i)&&!(r&&i)?Qe(this):new this.Collection(this,function(){return be(t,n,!r,!i)})}catch{return re(this,de)}},e.prototype.equals=function(t){return t==null?re(this,de):new this.Collection(this,function(){return kr(t)})},e.prototype.above=function(t){return t==null?re(this,de):new this.Collection(this,function(){return be(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?re(this,de):new this.Collection(this,function(){return be(t,void 0,!1)})},e.prototype.below=function(t){return t==null?re(this,de):new this.Collection(this,function(){return be(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?re(this,de):new this.Collection(this,function(){return be(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?re(this,vr):this.between(t,t+De,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):St(this,function(n,r){return n.indexOf(r[0])===0},[t],De)},e.prototype.equalsIgnoreCase=function(t){return St(this,function(n,r){return n===r[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=he.apply(Fe,arguments);return t.length===0?Qe(this):St(this,function(n,r){return r.indexOf(n)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=he.apply(Fe,arguments);return t.length===0?Qe(this):St(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},t,De)},e.prototype.anyOf=function(){var t=this,n=he.apply(Fe,arguments),r=this._cmp;try{n.sort(r)}catch{return re(this,de)}if(n.length===0)return Qe(this);var i=new this.Collection(this,function(){return be(n[0],n[n.length-1])});i._ondirectionchange=function(o){r=o==="next"?t._ascending:t._descending,n.sort(r)};var a=0;return i._addAlgorithm(function(o,u,s){for(var c=o.key;r(c,n[a])>0;)if(++a,a===n.length)return u(s),!1;return r(c,n[a])===0?!0:(u(function(){o.continue(n[a])}),!1)}),i},e.prototype.notEqual=function(t){return this.inAnyRange([[hn,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=he.apply(Fe,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return re(this,de)}var n=t.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[hn,i]]},null);return n.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,n){var r=this,i=this._cmp,a=this._ascending,o=this._descending,u=this._min,s=this._max;if(t.length===0)return Qe(this);if(!t.every(function(x){return x[0]!==void 0&&x[1]!==void 0&&a(x[0],x[1])<=0}))return re(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",K.InvalidArgument);var c=!n||n.includeLowers!==!1,d=n&&n.includeUppers===!0;function l(x,I){for(var P=0,T=x.length;P<T;++P){var B=x[P];if(i(I[0],B[1])<0&&i(I[1],B[0])>0){B[0]=u(B[0],I[0]),B[1]=s(B[1],I[1]);break}}return P===T&&x.push(I),x}var y=a;function E(x,I){return y(x[0],I[0])}var f;try{f=t.reduce(l,[]),f.sort(E)}catch{return re(this,de)}var p=0,m=d?function(x){return a(x,f[p][1])>0}:function(x){return a(x,f[p][1])>=0},g=c?function(x){return o(x,f[p][0])>0}:function(x){return o(x,f[p][0])>=0};function w(x){return!m(x)&&!g(x)}var _=m,k=new this.Collection(this,function(){return be(f[0][0],f[f.length-1][1],!c,!d)});return k._ondirectionchange=function(x){x==="next"?(_=m,y=a):(_=g,y=o),f.sort(E)},k._addAlgorithm(function(x,I,P){for(var T=x.key;_(T);)if(++p,p===f.length)return I(P),!1;return w(T)?!0:(r._cmp(T,f[p][1])===0||r._cmp(T,f[p][0])===0||I(function(){y===a?x.continue(f[p][0]):x.continue(f[p][1])}),!1)}),k},e.prototype.startsWithAnyOf=function(){var t=he.apply(Fe,arguments);return t.every(function(n){return typeof n=="string"})?t.length===0?Qe(this):this.inAnyRange(t.map(function(n){return[n,n+De]})):re(this,"startsWithAnyOf() only works with strings")},e}();function Zi(e){return tt(Er.prototype,function(n,r,i){if(this.db=e,this._ctx={table:n,index:r===":id"?null:r,or:i},this._cmp=this._ascending=z,this._descending=function(a,o){return z(o,a)},this._max=function(a,o){return z(a,o)>0?a:o},this._min=function(a,o){return z(a,o)<0?a:o},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new K.MissingAPI})}function se(e){return Y(function(t){return rt(t),e(t.target.error),!1})}function rt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var it="storagemutated",gn="x-storagemutated-1",we=et(null,it),qi=function(){function e(){}return e.prototype._lock=function(){return Ye(!O.global),++this._reculock,this._reculock===1&&!O.global&&(O.lockOwnerFor=this),this},e.prototype._unlock=function(){if(Ye(!O.global),--this._reculock===0)for(O.global||(O.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{Ae(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&O.lockOwnerFor!==this},e.prototype.create=function(t){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(Ye(!this.idbtrans),!t&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new K.DatabaseClosed(i);case"MissingAPIError":throw new K.MissingAPI(i.message,i);default:throw new K.OpenFailed(i)}if(!this.active)throw new K.TransactionInactive;return Ye(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=Y(function(a){rt(a),n._reject(t.error)}),t.onabort=Y(function(a){rt(a),n.active&&n._reject(new K.Abort(t.error)),n.active=!1,n.on("abort").fire(a)}),t.oncomplete=Y(function(){n.active=!1,n._resolve(),"mutatedParts"in t&&we.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,n,r){var i=this;if(t==="readwrite"&&this.mode!=="readwrite")return G(new K.ReadOnly("Transaction is readonly"));if(!this.active)return G(new K.TransactionInactive);if(this._locked())return new S(function(o,u){i._blockedFuncs.push([function(){i._promise(t,n,r).then(o,u)},O])});if(r)return ye(function(){var o=new S(function(u,s){i._lock();var c=n(u,s,i);c&&c.then&&c.then(u,s)});return o.finally(function(){return i._unlock()}),o._lib=!0,o});var a=new S(function(o,u){var s=n(o,u,i);s&&s.then&&s.then(o,u)});return a._lib=!0,a},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var n=this._root(),r=S.resolve(t);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=o)})()}var a=n._waitingFor;return new S(function(o,u){r.then(function(s){return n._waitingQueue.push(Y(o.bind(null,s)))},function(s){return n._waitingQueue.push(Y(u.bind(null,s)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new K.Abort))},e.prototype.table=function(t){var n=this._memoizedTables||(this._memoizedTables={});if($(n,t))return n[t];var r=this.schema[t];if(!r)throw new K.NotFound("Table "+t+" not part of transaction");var i=new this.db.Table(t,r,this);return i.core=this.db.core.table(t),n[t]=i,i},e}();function ea(e){return tt(qi.prototype,function(n,r,i,a,o){var u=this;this.db=e,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=a,this.idbtrans=null,this.on=et(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new S(function(s,c){u._resolve=s,u._reject=c}),this._completion.then(function(){u.active=!1,u.on.complete.fire()},function(s){var c=u.active;return u.active=!1,u.on.error.fire(s),u.parent?u.parent._reject(s):c&&u.idbtrans&&u.idbtrans.abort(),G(s)})})}function bn(e,t,n,r,i,a,o){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:a,src:(n&&!o?"&":"")+(r?"*":"")+(i?"++":"")+Ir(t)}}function Ir(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function wn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:hi(n,function(r){return[r.name,r]})}}function ta(e){return e.length===1?e[0]:e}var at=function(e){try{return e.only([[]]),at=function(){return[[]]},[[]]}catch{return at=function(){return De},De}};function xn(e){return e==null?function(){}:typeof e=="string"?na(e):function(t){return fe(t,e)}}function na(e){var t=e.split(".");return t.length===1?function(n){return n[e]}:function(n){return fe(n,e)}}function Sr(e){return[].slice.call(e)}var ra=0;function ot(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function ia(e,t,n){function r(l,y){var E=Sr(l.objectStoreNames);return{schema:{name:l.name,tables:E.map(function(f){return y.objectStore(f)}).map(function(f){var p=f.keyPath,m=f.autoIncrement,g=j(p),w=p==null,_={},k={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:w,compound:g,keyPath:p,autoIncrement:m,unique:!0,extractKey:xn(p)},indexes:Sr(f.indexNames).map(function(x){return f.index(x)}).map(function(x){var I=x.name,P=x.unique,T=x.multiEntry,B=x.keyPath,A=j(B),R={name:I,compound:A,keyPath:B,unique:P,multiEntry:T,extractKey:xn(B)};return _[ot(B)]=R,R}),getIndexByKeyPath:function(x){return _[ot(x)]}};return _[":id"]=k.primaryKey,p!=null&&(_[ot(p)]=k.primaryKey),k})},hasGetAll:E.length>0&&"getAll"in y.objectStore(E[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var y=l.lower,E=l.upper,f=l.lowerOpen,p=l.upperOpen,m=y===void 0?E===void 0?null:t.upperBound(E,!!p):E===void 0?t.lowerBound(y,!!f):t.bound(y,E,!!f,!!p);return m}function a(l){var y=l.name;function E(m){var g=m.trans,w=m.type,_=m.keys,k=m.values,x=m.range;return new Promise(function(I,P){I=Y(I);var T=g.objectStore(y),B=T.keyPath==null,A=w==="put"||w==="add";if(!A&&w!=="delete"&&w!=="deleteRange")throw new Error("Invalid operation type: "+w);var R=(_||k||{length:1}).length;if(_&&k&&_.length!==k.length)throw new Error("Given keys array must have same length as given values array.");if(R===0)return I({numFailures:0,failures:{},results:[],lastResult:void 0});var V,F=[],Q=[],M=0,J=function(le){++M,rt(le)};if(w==="deleteRange"){if(x.type===4)return I({numFailures:M,failures:Q,results:[],lastResult:void 0});x.type===3?F.push(V=T.clear()):F.push(V=T.delete(i(x)))}else{var ae=A?B?[k,_]:[k,null]:[_,null],ke=ae[0],ce=ae[1];if(A)for(var ie=0;ie<R;++ie)F.push(V=ce&&ce[ie]!==void 0?T[w](ke[ie],ce[ie]):T[w](ke[ie])),V.onerror=J;else for(var ie=0;ie<R;++ie)F.push(V=T[w](ke[ie])),V.onerror=J}var Ee=function(le){var ct=le.target.result;F.forEach(function(oe,jt){return oe.error!=null&&(Q[jt]=oe.error)}),I({numFailures:M,failures:Q,results:w==="delete"?_:F.map(function(oe){return oe.result}),lastResult:ct})};V.onerror=function(le){J(le),Ee(le)},V.onsuccess=Ee})}function f(m){var g=m.trans,w=m.values,_=m.query,k=m.reverse,x=m.unique;return new Promise(function(I,P){I=Y(I);var T=_.index,B=_.range,A=g.objectStore(y),R=T.isPrimaryKey?A:A.index(T.name),V=k?x?"prevunique":"prev":x?"nextunique":"next",F=w||!("openKeyCursor"in R)?R.openCursor(i(B),V):R.openKeyCursor(i(B),V);F.onerror=se(P),F.onsuccess=Y(function(Q){var M=F.result;if(!M){I(null);return}M.___id=++ra,M.done=!1;var J=M.continue.bind(M),ae=M.continuePrimaryKey;ae&&(ae=ae.bind(M));var ke=M.advance.bind(M),ce=function(){throw new Error("Cursor not started")},ie=function(){throw new Error("Cursor not stopped")};M.trans=g,M.stop=M.continue=M.continuePrimaryKey=M.advance=ce,M.fail=Y(P),M.next=function(){var Ee=this,le=1;return this.start(function(){return le--?Ee.continue():Ee.stop()}).then(function(){return Ee})},M.start=function(Ee){var le=new Promise(function(oe,jt){oe=Y(oe),F.onerror=se(jt),M.fail=jt,M.stop=function(Qa){M.stop=M.continue=M.continuePrimaryKey=M.advance=ie,oe(Qa)}}),ct=function(){if(F.result)try{Ee()}catch(oe){M.fail(oe)}else M.done=!0,M.start=function(){throw new Error("Cursor behind last entry")},M.stop()};return F.onsuccess=Y(function(oe){F.onsuccess=ct,ct()}),M.continue=J,M.continuePrimaryKey=ae,M.advance=ke,ct(),le},I(M)},P)})}function p(m){return function(g){return new Promise(function(w,_){w=Y(w);var k=g.trans,x=g.values,I=g.limit,P=g.query,T=I===1/0?void 0:I,B=P.index,A=P.range,R=k.objectStore(y),V=B.isPrimaryKey?R:R.index(B.name),F=i(A);if(I===0)return w({result:[]});if(m){var Q=x?V.getAll(F,T):V.getAllKeys(F,T);Q.onsuccess=function(ke){return w({result:ke.target.result})},Q.onerror=se(_)}else{var M=0,J=x||!("openKeyCursor"in V)?V.openCursor(F):V.openKeyCursor(F),ae=[];J.onsuccess=function(ke){var ce=J.result;if(!ce)return w({result:ae});if(ae.push(x?ce.value:ce.primaryKey),++M===I)return w({result:ae});ce.continue()},J.onerror=se(_)}})}}return{name:y,schema:l,mutate:E,getMany:function(m){var g=m.trans,w=m.keys;return new Promise(function(_,k){_=Y(_);for(var x=g.objectStore(y),I=w.length,P=new Array(I),T=0,B=0,A,R=function(M){var J=M.target;(P[J._pos]=J.result)!=null,++B===T&&_(P)},V=se(k),F=0;F<I;++F){var Q=w[F];Q!=null&&(A=x.get(w[F]),A._pos=F,A.onsuccess=R,A.onerror=V,++T)}T===0&&_(P)})},get:function(m){var g=m.trans,w=m.key;return new Promise(function(_,k){_=Y(_);var x=g.objectStore(y),I=x.get(w);I.onsuccess=function(P){return _(P.target.result)},I.onerror=se(k)})},query:p(s),openCursor:f,count:function(m){var g=m.query,w=m.trans,_=g.index,k=g.range;return new Promise(function(x,I){var P=w.objectStore(y),T=_.isPrimaryKey?P:P.index(_.name),B=i(k),A=B?T.count(B):T.count();A.onsuccess=Y(function(R){return x(R.target.result)}),A.onerror=se(I)})}}}var o=r(e,n),u=o.schema,s=o.hasGetAll,c=u.tables.map(function(l){return a(l)}),d={};return c.forEach(function(l){return d[l.name]=l}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(l){var y=d[l];if(!y)throw new Error("Table '".concat(l,"' not found"));return d[l]},MIN_KEY:-1/0,MAX_KEY:at(t),schema:u}}function aa(e,t){return t.reduce(function(n,r){var i=r.create;return b(b({},n),i(n))},e)}function oa(e,t,n,r){var i=n.IDBKeyRange;n.indexedDB;var a=aa(ia(t,i,r),e.dbcore);return{dbcore:a}}function Pt(e,t){var n=t.db,r=oa(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach(function(i){var a=i.name;e.core.schema.tables.some(function(o){return o.name===a})&&(i.core=e.core.table(a),e[a]instanceof e.Table&&(e[a].core=i.core))})}function Ct(e,t,n,r){n.forEach(function(i){var a=r[i];t.forEach(function(o){var u=Gn(o,i);(!u||"value"in u&&u.value===void 0)&&(o===e.Transaction.prototype||o instanceof e.Transaction?te(o,i,{get:function(){return this.table(i)},set:function(s){q(this,i,{value:s,writable:!0,configurable:!0,enumerable:!0})}}):o[i]=new e.Table(i,a))})})}function _n(e,t){t.forEach(function(n){for(var r in n)n[r]instanceof e.Table&&delete n[r]})}function ua(e,t){return e._cfg.version-t._cfg.version}function sa(e,t,n,r){var i=e._dbSchema;n.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=wn("$meta",Cr("")[0],[]),e._storeNames.push("$meta"));var a=e._createTransaction("readwrite",e._storeNames,i);a.create(n),a._completion.catch(r);var o=a._reject.bind(a),u=O.transless||O;ye(function(){if(O.trans=a,O.transless=u,t===0)N(i).forEach(function(s){En(n,s,i[s].primKey,i[s].indexes)}),Pt(e,n),S.follow(function(){return e.on.populate.fire(a)}).catch(o);else return Pt(e,n),la(e,a,t).then(function(s){return fa(e,s,a,n)}).catch(o)})}function ca(e,t){Pr(e._dbSchema,t),t.db.version%10===0&&!t.objectStoreNames.contains("$meta")&&t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=At(e,e.idbdb,t);Dt(e,e._dbSchema,t);for(var r=kn(n,e._dbSchema),i=function(c){if(c.change.length||c.recreate)return console.warn("Unable to patch indexes of table ".concat(c.name," because it has changes on the type of index or primary key.")),{value:void 0};var d=t.objectStore(c.name);c.add.forEach(function(l){ue&&console.debug("Dexie upgrade patch: Creating missing index ".concat(c.name,".").concat(l.src)),Tt(d,l)})},a=0,o=r.change;a<o.length;a++){var u=o[a],s=i(u);if(typeof s=="object")return s.value}}function la(e,t,n){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then(function(r){return r??n}):S.resolve(n)}function fa(e,t,n,r){var i=[],a=e._versions,o=e._dbSchema=At(e,e.idbdb,r),u=a.filter(function(c){return c._cfg.version>=t});if(u.length===0)return S.resolve();u.forEach(function(c){i.push(function(){var d=o,l=c._cfg.dbschema;Dt(e,d,r),Dt(e,l,r),o=e._dbSchema=l;var y=kn(d,l);y.add.forEach(function(w){En(r,w[0],w[1].primKey,w[1].indexes)}),y.change.forEach(function(w){if(w.recreate)throw new K.Upgrade("Not yet support for changing primary key");var _=r.objectStore(w.name);w.add.forEach(function(k){return Tt(_,k)}),w.change.forEach(function(k){_.deleteIndex(k.name),Tt(_,k)}),w.del.forEach(function(k){return _.deleteIndex(k)})});var E=c._cfg.contentUpgrade;if(E&&c._cfg.version>t){Pt(e,r),n._memoizedTables={};var f=Zn(l);y.del.forEach(function(w){f[w]=d[w]}),_n(e,[e.Transaction.prototype]),Ct(e,[e.Transaction.prototype],N(f),f),n.schema=f;var p=Jt(E);p&&ze();var m,g=S.follow(function(){if(m=E(n),m&&p){var w=me.bind(null,null);m.then(w,w)}});return m&&typeof m.then=="function"?S.resolve(m):g.then(function(){return m})}}),i.push(function(d){var l=c._cfg.dbschema;ha(l,d),_n(e,[e.Transaction.prototype]),Ct(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}),i.push(function(d){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===c._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(l){return l!=="$meta"})):d.objectStore("$meta").put(c._cfg.version,"version"))})});function s(){return i.length?S.resolve(i.shift()(n.idbtrans)).then(s):S.resolve()}return s().then(function(){Pr(o,r)})}function kn(e,t){var n={del:[],add:[],change:[]},r;for(r in e)t[r]||n.del.push(r);for(r in t){var i=e[r],a=t[r];if(!i)n.add.push([r,a]);else{var o={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto)o.recreate=!0,n.change.push(o);else{var u=i.idxByName,s=a.idxByName,c=void 0;for(c in u)s[c]||o.del.push(c);for(c in s){var d=u[c],l=s[c];d?d.src!==l.src&&o.change.push(l):o.add.push(l)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}}return n}function En(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(a){return Tt(i,a)}),i}function Pr(e,t){N(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(ue&&console.debug("Dexie: Creating missing table",n),En(t,n,e[n].primKey,e[n].indexes))})}function ha(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(n){return e[n]==null&&t.db.deleteObjectStore(n)})}function Tt(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function At(e,t,n){var r={},i=ft(t.objectStoreNames,0);return i.forEach(function(a){for(var o=n.objectStore(a),u=o.keyPath,s=bn(Ir(u),u||"",!0,!1,!!o.autoIncrement,u&&typeof u!="string",!0),c=[],d=0;d<o.indexNames.length;++d){var l=o.index(o.indexNames[d]);u=l.keyPath;var y=bn(l.name,u,!!l.unique,!!l.multiEntry,!1,u&&typeof u!="string",!1);c.push(y)}r[a]=wn(a,s,c)}),r}function da(e,t,n){e.verno=t.version/10;var r=e._dbSchema=At(e,t,n);e._storeNames=ft(t.objectStoreNames,0),Ct(e,[e._allTables],N(r),r)}function pa(e,t){var n=At(e,e.idbdb,t),r=kn(n,e._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function Dt(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var a=r[i],o=n.objectStore(a);e._hasGetAll="getAll"in o;for(var u=0;u<o.indexNames.length;++u){var s=o.indexNames[u],c=o.index(s).keyPath,d=typeof c=="string"?c:"["+ft(c).join("+")+"]";if(t[a]){var l=t[a].idxByName[d];l&&(l.name=s,delete t[a].idxByName[d],t[a].idxByName[s]=l)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&D.WorkerGlobalScope&&D instanceof D.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Cr(e){return e.split(",").map(function(t,n){t=t.trim();var r=t.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return bn(r,i||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),j(i),n===0)})}var va=function(){function e(){}return e.prototype._parseStoresSpec=function(t,n){N(t).forEach(function(r){if(t[r]!==null){var i=Cr(t[r]),a=i.shift();if(a.unique=!0,a.multi)throw new K.Schema("Primary key cannot be multi-valued");i.forEach(function(o){if(o.auto)throw new K.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new K.Schema("Index must have a name and cannot be an empty string")}),n[r]=wn(r,a,i)}})},e.prototype.stores=function(t){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?L(this._cfg.storesSource,t):t;var r=n._versions,i={},a={};return r.forEach(function(o){L(i,o._cfg.storesSource),a=o._cfg.dbschema={},o._parseStoresSpec(i,a)}),n._dbSchema=a,_n(n,[n._allTables,n,n.Transaction.prototype]),Ct(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],N(a),a),n._storeNames=N(a),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=en(this._cfg.contentUpgrade||W,t),this},e}();function ya(e){return tt(va.prototype,function(n){this.db=e,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function In(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new pe(_t,{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function Sn(e){return e&&typeof e.databases=="function"}function ma(e){var t=e.indexedDB,n=e.IDBKeyRange;return Sn(t)?Promise.resolve(t.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==_t})}):In(t,n).toCollection().primaryKeys()}function ga(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!Sn(n)&&t!==_t&&In(n,r).put({name:t}).catch(W)}function ba(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!Sn(n)&&t!==_t&&In(n,r).delete(t).catch(W)}function Pn(e){return ye(function(){return O.letThrough=!0,e()})}function wa(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};t=setInterval(r,100),r()}).finally(function(){return clearInterval(t)})}var Cn;function Tn(e){return!("from"in e)}var ee=function(e,t){if(this)L(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var n=new ee;return e&&"d"in e&&L(n,e),n}};Z(ee.prototype,(Cn={add:function(e){return st(this,e),this},addKey:function(e){return ut(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return ut(t,n,n)}),this},hasKey:function(e){var t=Ot(this).next(e).value;return t&&z(t.from,e)<=0&&z(t.to,e)>=0}},Cn[Xt]=function(){return Ot(this)},Cn));function ut(e,t,n){var r=z(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(Tn(e))return L(e,{from:t,to:n,d:1});var i=e.l,a=e.r;if(z(n,e.from)<0)return i?ut(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Ar(e);if(z(t,e.to)>0)return a?ut(a,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Ar(e);z(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),z(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var o=!e.r;i&&!e.l&&st(e,i),a&&o&&st(e,a)}}function st(e,t){function n(r,i){var a=i.from,o=i.to,u=i.l,s=i.r;ut(r,a,o),u&&n(r,u),s&&n(r,s)}Tn(t)||n(e,t)}function Tr(e,t){var n=Ot(t),r=n.next();if(r.done)return!1;for(var i=r.value,a=Ot(e),o=a.next(i.from),u=o.value;!r.done&&!o.done;){if(z(u.from,i.to)<=0&&z(u.to,i.from)>=0)return!0;z(i.from,u.from)<0?i=(r=n.next(u.from)).value:u=(o=a.next(i.from)).value}return!1}function Ot(e){var t=Tn(e)?null:{s:0,n:e};return{next:function(n){for(var r=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&z(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||z(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Ar(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var a=i==="r"?"l":"r",o=b({},e),u=e[i];e.from=u.from,e.to=u.to,e[i]=u[i],o[i]=u[a],e[a]=o,o.d=Dr(o)}e.d=Dr(e)}function Dr(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function Kt(e,t){return N(t).forEach(function(n){e[n]?st(e[n],t[n]):e[n]=tr(t[n])}),e}function An(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&Tr(t[n],e[n])})}var Ke={},Dn={},On=!1;function Rt(e,t){Kt(Dn,e),On||(On=!0,setTimeout(function(){On=!1;var n=Dn;Dn={},Kn(n,!1)},0))}function Kn(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,i=Object.values(Ke);r<i.length;r++){var a=i[r];Or(a,e,n,t)}else for(var o in e){var u=/^idb\:\/\/(.*)\/(.*)\//.exec(o);if(u){var s=u[1],c=u[2],a=Ke["idb://".concat(s,"/").concat(c)];a&&Or(a,e,n,t)}}n.forEach(function(d){return d()})}function Or(e,t,n,r){for(var i=[],a=0,o=Object.entries(e.queries.query);a<o.length;a++){for(var u=o[a],s=u[0],c=u[1],d=[],l=0,y=c;l<y.length;l++){var E=y[l];An(t,E.obsSet)?E.subscribers.forEach(function(g){return n.add(g)}):r&&d.push(E)}r&&i.push([s,d])}if(r)for(var f=0,p=i;f<p.length;f++){var m=p[f],s=m[0],d=m[1];e.queries.query[s]=d}}function xa(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?G(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,i=Math.round(e.verno*10),a=!1;function o(){if(t.openCanceller!==r)throw new K.DatabaseClosed("db.open() was cancelled")}var u=t.dbReadyResolve,s=null,c=!1,d=function(){return new S(function(l,y){if(o(),!n)throw new K.MissingAPI;var E=e.name,f=t.autoSchema||!i?n.open(E):n.open(E,i);if(!f)throw new K.MissingAPI;f.onerror=se(y),f.onblocked=Y(e._fireOnBlocked),f.onupgradeneeded=Y(function(p){if(s=f.transaction,t.autoSchema&&!e._options.allowEmptyDB){f.onerror=rt,s.abort(),f.result.close();var m=n.deleteDatabase(E);m.onsuccess=m.onerror=Y(function(){y(new K.NoSuchDatabase("Database ".concat(E," doesnt exist")))})}else{s.onerror=se(y);var g=p.oldVersion>Math.pow(2,62)?0:p.oldVersion;c=g<1,e.idbdb=f.result,a&&ca(e,s),sa(e,g/10,s,y)}},y),f.onsuccess=Y(function(){s=null;var p=e.idbdb=f.result,m=ft(p.objectStoreNames);if(m.length>0)try{var g=p.transaction(ta(m),"readonly");if(t.autoSchema)da(e,p,g);else if(Dt(e,e._dbSchema,g),!pa(e,g)&&!a)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),p.close(),i=p.version+1,a=!0,l(d());Pt(e,g)}catch{}$e.push(e),p.onversionchange=Y(function(w){t.vcFired=!0,e.on("versionchange").fire(w)}),p.onclose=Y(function(w){e.on("close").fire(w)}),c&&ga(e._deps,E),l()},y)}).catch(function(l){switch(l?.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),d();break;case"VersionError":if(i>0)return i=0,d();break}return S.reject(l)})};return S.race([r,(typeof navigator>"u"?S.resolve():wa()).then(d)]).then(function(){return o(),t.onReadyBeingFired=[],S.resolve(Pn(function(){return e.on.ready.fire(e.vip)})).then(function l(){if(t.onReadyBeingFired.length>0){var y=t.onReadyBeingFired.reduce(en,W);return t.onReadyBeingFired=[],S.resolve(Pn(function(){return y(e.vip)})).then(l)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(l){t.dbOpenError=l;try{s&&s.abort()}catch{}return r===t.openCanceller&&e._close(),G(l)}).finally(function(){t.openComplete=!0,u()}).then(function(){if(c){var l={};e.tables.forEach(function(y){y.schema.indexes.forEach(function(E){E.name&&(l["idb://".concat(e.name,"/").concat(y.name,"/").concat(E.name)]=new ee(-1/0,[[[]]]))}),l["idb://".concat(e.name,"/").concat(y.name,"/")]=l["idb://".concat(e.name,"/").concat(y.name,"/:dels")]=new ee(-1/0,[[[]]])}),we(it).fire(l),Kn(l,!0)}return e})}function Rn(e){var t=function(o){return e.next(o)},n=function(o){return e.throw(o)},r=a(t),i=a(n);function a(o){return function(u){var s=o(u),c=s.value;return s.done?c:!c||typeof c.then!="function"?j(c)?Promise.all(c).then(r,i):r(c):c.then(r,i)}}return a(t)()}function _a(e,t,n){var r=arguments.length;if(r<2)throw new K.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var a=qn(i);return[e,a,n]}function Kr(e,t,n,r,i){return S.resolve().then(function(){var a=O.transless||O,o=e._createTransaction(t,n,e._dbSchema,r);o.explicit=!0;var u={trans:o,transless:a};if(r)o.idbtrans=r.idbtrans;else try{o.create(),o.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(l){return l.name===qt.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return Kr(e,t,n,null,i)})):G(l)}var s=Jt(i);s&&ze();var c,d=S.follow(function(){if(c=i.call(o,o),c)if(s){var l=me.bind(null,null);c.then(l,l)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=Rn(c))},u);return(c&&typeof c.then=="function"?S.resolve(c).then(function(l){return o.active?l:G(new K.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):d.then(function(){return c})).then(function(l){return r&&o._resolve(),o._completion.then(function(){return l})}).catch(function(l){return o._reject(l),G(l)})})}function Mt(e,t,n){for(var r=j(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}function ka(e){return b(b({},e),{table:function(t){var n=e.table(t),r=n.schema,i={},a=[];function o(p,m,g){var w=ot(p),_=i[w]=i[w]||[],k=p==null?0:typeof p=="string"?1:p.length,x=m>0,I=b(b({},g),{name:x?"".concat(w,"(virtual-from:").concat(g.name,")"):g.name,lowLevelIndex:g,isVirtual:x,keyTail:m,keyLength:k,extractKey:xn(p),unique:!x&&g.unique});if(_.push(I),I.isPrimaryKey||a.push(I),k>1){var P=k===2?p[0]:p.slice(0,k-1);o(P,m+1,g)}return _.sort(function(T,B){return T.keyTail-B.keyTail}),I}var u=o(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[u];for(var s=0,c=r.indexes;s<c.length;s++){var d=c[s];o(d.keyPath,0,d)}function l(p){var m=i[ot(p)];return m&&m[0]}function y(p,m){return{type:p.type===1?2:p.type,lower:Mt(p.lower,p.lowerOpen?e.MAX_KEY:e.MIN_KEY,m),lowerOpen:!0,upper:Mt(p.upper,p.upperOpen?e.MIN_KEY:e.MAX_KEY,m),upperOpen:!0}}function E(p){var m=p.query.index;return m.isVirtual?b(b({},p),{query:{index:m.lowLevelIndex,range:y(p.query.range,m.keyTail)}}):p}var f=b(b({},n),{schema:b(b({},r),{primaryKey:u,indexes:a,getIndexByKeyPath:l}),count:function(p){return n.count(E(p))},query:function(p){return n.query(E(p))},openCursor:function(p){var m=p.query.index,g=m.keyTail,w=m.isVirtual,_=m.keyLength;if(!w)return n.openCursor(p);function k(x){function I(T){T!=null?x.continue(Mt(T,p.reverse?e.MAX_KEY:e.MIN_KEY,g)):p.unique?x.continue(x.key.slice(0,_).concat(p.reverse?e.MIN_KEY:e.MAX_KEY,g)):x.continue()}var P=Object.create(x,{continue:{value:I},continuePrimaryKey:{value:function(T,B){x.continuePrimaryKey(Mt(T,e.MAX_KEY,g),B)}},primaryKey:{get:function(){return x.primaryKey}},key:{get:function(){var T=x.key;return _===1?T[0]:T.slice(0,_)}},value:{get:function(){return x.value}}});return P}return n.openCursor(E(p)).then(function(x){return x&&k(x)})}});return f}})}var Ea={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:ka};function Mn(e,t,n,r){return n=n||{},r=r||"",N(e).forEach(function(i){if(!$(t,i))n[r+i]=void 0;else{var a=e[i],o=t[i];if(typeof a=="object"&&typeof o=="object"&&a&&o){var u=Gt(a),s=Gt(o);u!==s?n[r+i]=t[i]:u==="Object"?Mn(a,o,n,r+i+"."):a!==o&&(n[r+i]=t[i])}else a!==o&&(n[r+i]=t[i])}}),N(t).forEach(function(i){$(e,i)||(n[r+i]=t[i])}),n}function Bn(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Ia={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return b(b({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey,i=b(b({},n),{mutate:function(a){var o=O.trans,u=o.table(t).hook,s=u.deleting,c=u.creating,d=u.updating;switch(a.type){case"add":if(c.fire===W)break;return o._promise("readwrite",function(){return l(a)},!0);case"put":if(c.fire===W&&d.fire===W)break;return o._promise("readwrite",function(){return l(a)},!0);case"delete":if(s.fire===W)break;return o._promise("readwrite",function(){return l(a)},!0);case"deleteRange":if(s.fire===W)break;return o._promise("readwrite",function(){return y(a)},!0)}return n.mutate(a);function l(f){var p=O.trans,m=f.keys||Bn(r,f);if(!m)throw new Error("Keys missing");return f=f.type==="add"||f.type==="put"?b(b({},f),{keys:m}):b({},f),f.type!=="delete"&&(f.values=C([],f.values,!0)),f.keys&&(f.keys=C([],f.keys,!0)),Sa(n,f,m).then(function(g){var w=m.map(function(_,k){var x=g[k],I={onerror:null,onsuccess:null};if(f.type==="delete")s.fire.call(I,_,x,p);else if(f.type==="add"||x===void 0){var P=c.fire.call(I,_,f.values[k],p);_==null&&P!=null&&(_=P,f.keys[k]=_,r.outbound||ne(f.values[k],r.keyPath,_))}else{var T=Mn(x,f.values[k]),B=d.fire.call(I,T,_,x,p);if(B){var A=f.values[k];Object.keys(B).forEach(function(R){$(A,R)?A[R]=B[R]:ne(A,R,B[R])})}}return I});return n.mutate(f).then(function(_){for(var k=_.failures,x=_.results,I=_.numFailures,P=_.lastResult,T=0;T<m.length;++T){var B=x?x[T]:m[T],A=w[T];B==null?A.onerror&&A.onerror(k[T]):A.onsuccess&&A.onsuccess(f.type==="put"&&g[T]?f.values[T]:B)}return{failures:k,results:x,numFailures:I,lastResult:P}}).catch(function(_){return w.forEach(function(k){return k.onerror&&k.onerror(_)}),Promise.reject(_)})})}function y(f){return E(f.trans,f.range,1e4)}function E(f,p,m){return n.query({trans:f,values:!1,query:{index:r,range:p},limit:m}).then(function(g){var w=g.result;return l({type:"delete",keys:w,trans:f}).then(function(_){return _.numFailures>0?Promise.reject(_.failures[0]):w.length<m?{failures:[],numFailures:0,lastResult:void 0}:E(f,b(b({},p),{lower:w[w.length-1],lowerOpen:!0}),m)})})}}});return i}})}};function Sa(e,t,n){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function Rr(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,a=0;i<t.keys.length&&a<e.length;++i)z(t.keys[i],e[a])===0&&(r.push(n?Ie(t.values[i]):t.values[i]),++a);return r.length===e.length?r:null}catch{return null}}var Pa={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return b(b({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=Rr(r.keys,r.trans._cache,r.cache==="clone");return i?S.resolve(i):n.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Ie(a):a},a})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}};function Mr(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function Br(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":return!1;case"getMany":return!1;case"count":return!1;case"openCursor":return!1}}var Ca={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new ee(e.MIN_KEY,e.MAX_KEY);return b(b({},e),{transaction:function(r,i,a){if(O.subscr&&i!=="readonly")throw new K.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(O.querier));return e.transaction(r,i,a)},table:function(r){var i=e.table(r),a=i.schema,o=a.primaryKey,u=a.indexes,s=o.extractKey,c=o.outbound,d=o.autoIncrement&&u.filter(function(f){return f.compound&&f.keyPath.includes(o.keyPath)}),l=b(b({},i),{mutate:function(f){var p=f.trans,m=f.mutatedParts||(f.mutatedParts={}),g=function(R){var V="idb://".concat(t,"/").concat(r,"/").concat(R);return m[V]||(m[V]=new ee)},w=g(""),_=g(":dels"),k=f.type,x=f.type==="deleteRange"?[f.range]:f.type==="delete"?[f.keys]:f.values.length<50?[Bn(o,f).filter(function(R){return R}),f.values]:[],I=x[0],P=x[1],T=f.trans._cache;if(j(I)){w.addKeys(I);var B=k==="delete"||I.length===P.length?Rr(I,T):null;B||_.addKeys(I),(B||P)&&Ta(g,a,B,P)}else if(I){var A={from:I.lower,to:I.upper};_.add(A),w.add(A)}else w.add(n),_.add(n),a.indexes.forEach(function(R){return g(R.name).add(n)});return i.mutate(f).then(function(R){return I&&(f.type==="add"||f.type==="put")&&(w.addKeys(R.results),d&&d.forEach(function(V){var F=f.values.map(function(M){return V.extractKey(M)}),Q=V.keyPath.findIndex(function(M){return M===o.keyPath});R.results.forEach(function(M){return F[Q]=M}),g(V.name).addKeys(F)})),p.mutatedParts=Kt(p.mutatedParts||{},m),R})}}),y=function(f){var p,m,g=f.query,w=g.index,_=g.range;return[w,new ee((p=_.lower)!==null&&p!==void 0?p:e.MIN_KEY,(m=_.upper)!==null&&m!==void 0?m:e.MAX_KEY)]},E={get:function(f){return[o,new ee(f.key)]},getMany:function(f){return[o,new ee().addKeys(f.keys)]},count:y,query:y,openCursor:y};return N(E).forEach(function(f){l[f]=function(p){var m=O.subscr,g=!!m,w=Mr(O,i)&&Br(f,p),_=w?p.obsSet={}:m;if(g){var k=function(R){var V="idb://".concat(t,"/").concat(r,"/").concat(R);return _[V]||(_[V]=new ee)},x=k(""),I=k(":dels"),P=E[f](p),T=P[0],B=P[1];if(f==="query"&&T.isPrimaryKey&&!p.values?I.add(B):k(T.name||"").add(B),!T.isPrimaryKey)if(f==="count")I.add(n);else{var A=f==="query"&&c&&p.values&&i.query(b(b({},p),{values:!1}));return i[f].apply(this,arguments).then(function(R){if(f==="query"){if(c&&p.values)return A.then(function(M){var J=M.result;return x.addKeys(J),R});var V=p.values?R.result.map(s):R.result;p.values?x.addKeys(V):I.addKeys(V)}else if(f==="openCursor"){var F=R,Q=p.values;return F&&Object.create(F,{key:{get:function(){return I.addKey(F.primaryKey),F.key}},primaryKey:{get:function(){var M=F.primaryKey;return I.addKey(M),M}},value:{get:function(){return Q&&x.addKey(F.primaryKey),F.value}}})}return R})}}return i[f].apply(this,arguments)}}),l}})}};function Ta(e,t,n,r){function i(a){var o=e(a.name||"");function u(c){return c!=null?a.extractKey(c):null}var s=function(c){return a.multiEntry&&j(c)?c.forEach(function(d){return o.addKey(d)}):o.addKey(c)};(n||r).forEach(function(c,d){var l=n&&u(n[d]),y=r&&u(r[d]);z(l,y)!==0&&(l!=null&&s(l),y!=null&&s(y))})}t.indexes.forEach(i)}function Fr(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(n.numFailures===r)return null;var i=b({},t);return j(i.keys)&&(i.keys=i.keys.filter(function(a,o){return!(o in n.failures)})),"values"in i&&j(i.values)&&(i.values=i.values.filter(function(a,o){return!(o in n.failures)})),i}function Aa(e,t){return t.lower===void 0?!0:t.lowerOpen?z(e,t.lower)>0:z(e,t.lower)>=0}function Da(e,t){return t.upper===void 0?!0:t.upperOpen?z(e,t.upper)<0:z(e,t.upper)<=0}function Fn(e,t){return Aa(e,t)&&Da(e,t)}function jr(e,t,n,r,i,a){if(!n||n.length===0)return e;var o=t.query.index,u=o.multiEntry,s=t.query.range,c=r.schema.primaryKey,d=c.extractKey,l=o.extractKey,y=(o.lowLevelIndex||o).extractKey,E=n.reduce(function(f,p){var m=f,g=[];if(p.type==="add"||p.type==="put")for(var w=new ee,_=p.values.length-1;_>=0;--_){var k=p.values[_],x=d(k);if(!w.hasKey(x)){var I=l(k);(u&&j(I)?I.some(function(A){return Fn(A,s)}):Fn(I,s))&&(w.addKey(x),g.push(k))}}switch(p.type){case"add":m=f.concat(t.values?g:g.map(function(A){return d(A)}));break;case"put":var P=new ee().addKeys(p.values.map(function(A){return d(A)}));m=f.filter(function(A){return!P.hasKey(t.values?d(A):A)}).concat(t.values?g:g.map(function(A){return d(A)}));break;case"delete":var T=new ee().addKeys(p.keys);m=f.filter(function(A){return!T.hasKey(t.values?d(A):A)});break;case"deleteRange":var B=p.range;m=f.filter(function(A){return!Fn(d(A),B)});break}return m},e);return E===e?e:(E.sort(function(f,p){return z(y(f),y(p))||z(d(f),d(p))}),t.limit&&t.limit<1/0&&(E.length>t.limit?E.length=t.limit:e.length===t.limit&&E.length<t.limit&&(i.dirty=!0)),a?Object.freeze(E):E)}function Nr(e,t){return z(e.lower,t.lower)===0&&z(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Oa(e,t,n,r){if(e===void 0)return t!==void 0?-1:0;if(t===void 0)return 1;var i=z(e,t);if(i===0){if(n&&r)return 0;if(n)return 1;if(r)return-1}return i}function Ka(e,t,n,r){if(e===void 0)return t!==void 0?1:0;if(t===void 0)return-1;var i=z(e,t);if(i===0){if(n&&r)return 0;if(n)return-1;if(r)return 1}return i}function Ra(e,t){return Oa(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&Ka(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function Ma(e,t,n,r){var i=Ke["idb://".concat(e,"/").concat(t)];if(!i)return[];var a=i.queries[n];if(!a)return[null,!1,i,null];var o=r.query?r.query.index.name:null,u=a[o||""];if(!u)return[null,!1,i,null];switch(n){case"query":var s=u.find(function(l){return l.req.limit===r.limit&&l.req.values===r.values&&Nr(l.req.query.range,r.query.range)});if(s)return[s,!0,i,u];var c=u.find(function(l){var y="limit"in l.req?l.req.limit:1/0;return y>=r.limit&&(r.values?l.req.values:!0)&&Ra(l.req.query.range,r.query.range)});return[c,!1,i,u];case"count":var d=u.find(function(l){return Nr(l.req.query.range,r.query.range)});return[d,!!d,i,u]}}function Ba(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){e.subscribers.delete(n),e.subscribers.size===0&&Fa(e,t)})}function Fa(e,t){setTimeout(function(){e.subscribers.size===0&&Se(t,e)},3e3)}var ja={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,n=b(b({},e),{transaction:function(r,i,a){var o=e.transaction(r,i,a);if(i==="readwrite"){var u=new AbortController,s=u.signal,c=function(d){return function(){if(u.abort(),i==="readwrite"){for(var l=new Set,y=0,E=r;y<E.length;y++){var f=E[y],p=Ke["idb://".concat(t,"/").concat(f)];if(p){var m=e.table(f),g=p.optimisticOps.filter(function(Q){return Q.trans===o});if(o._explicit&&d&&o.mutatedParts)for(var w=0,_=Object.values(p.queries.query);w<_.length;w++)for(var k=_[w],x=0,I=k.slice();x<I.length;x++){var P=I[x];An(P.obsSet,o.mutatedParts)&&(Se(k,P),P.subscribers.forEach(function(Q){return l.add(Q)}))}else if(g.length>0){p.optimisticOps=p.optimisticOps.filter(function(Q){return Q.trans!==o});for(var T=0,B=Object.values(p.queries.query);T<B.length;T++)for(var k=B[T],A=0,R=k.slice();A<R.length;A++){var P=R[A];if(P.res!=null&&o.mutatedParts)if(d&&!P.dirty){var V=Object.isFrozen(P.res),F=jr(P.res,P.req,g,m,P,V);P.dirty?(Se(k,P),P.subscribers.forEach(function(J){return l.add(J)})):F!==P.res&&(P.res=F,P.promise=S.resolve({result:F}))}else P.dirty&&Se(k,P),P.subscribers.forEach(function(J){return l.add(J)})}}}}l.forEach(function(Q){return Q()})}}};o.addEventListener("abort",c(!1),{signal:s}),o.addEventListener("error",c(!1),{signal:s}),o.addEventListener("complete",c(!0),{signal:s})}return o},table:function(r){var i=e.table(r),a=i.schema.primaryKey,o=b(b({},i),{mutate:function(u){var s=O.trans;if(a.outbound||s.db._options.cache==="disabled"||s.explicit)return i.mutate(u);var c=Ke["idb://".concat(t,"/").concat(r)];if(!c)return i.mutate(u);var d=i.mutate(u);return(u.type==="add"||u.type==="put")&&(u.values.length>=50||Bn(a,u).some(function(l){return l==null}))?d.then(function(l){var y=b(b({},u),{values:u.values.map(function(f,p){var m,g=!((m=a.keyPath)===null||m===void 0)&&m.includes(".")?Ie(f):b({},f);return ne(g,a.keyPath,l.results[p]),g})}),E=Fr(c,y,l);c.optimisticOps.push(E),queueMicrotask(function(){return u.mutatedParts&&Rt(u.mutatedParts)})}):(c.optimisticOps.push(u),u.mutatedParts&&Rt(u.mutatedParts),d.then(function(l){if(l.numFailures>0){Se(c.optimisticOps,u);var y=Fr(c,u,l);y&&c.optimisticOps.push(y),u.mutatedParts&&Rt(u.mutatedParts)}}),d.catch(function(){Se(c.optimisticOps,u),u.mutatedParts&&Rt(u.mutatedParts)})),d},query:function(u){var s;if(!Mr(O,i)||!Br("query",u))return i.query(u);var c=((s=O.trans)===null||s===void 0?void 0:s.db._options.cache)==="immutable",d=O,l=d.requery,y=d.signal,E=Ma(t,r,"query",u),f=E[0],p=E[1],m=E[2],g=E[3];if(f&&p)f.obsSet=u.obsSet;else{var w=i.query(u).then(function(_){var k=_.result;if(f&&(f.res=k),c){for(var x=0,I=k.length;x<I;++x)Object.freeze(k[x]);Object.freeze(k)}else _.result=Ie(k);return _}).catch(function(_){return g&&f&&Se(g,f),Promise.reject(_)});f={obsSet:u.obsSet,promise:w,subscribers:new Set,type:"query",req:u,dirty:!1},g?g.push(f):(g=[f],m||(m=Ke["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),m.queries.query[u.query.index.name||""]=g)}return Ba(f,g,l,y),f.promise.then(function(_){return{result:jr(_.result,u,m?.optimisticOps,i,f,c)}})}});return o}});return n}};function Bt(e,t){return new Proxy(e,{get:function(n,r,i){return r==="db"?t:Reflect.get(n,r,i)}})}var pe=function(){function e(t,n){var r=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=n=b({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:W,dbReadyPromise:null,cancelOpen:W,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:n.autoOpen};o.dbReadyPromise=new S(function(s){o.dbReadyResolve=s}),o.openCanceller=new S(function(s,c){o.cancelOpen=c}),this._state=o,this.name=t,this.on=et(this,"populate","blocked","versionchange","close",{ready:[en,W]}),this.on.ready.subscribe=Xn(this.on.ready.subscribe,function(s){return function(c,d){e.vip(function(){var l=r._state;if(l.openComplete)l.dbOpenError||S.resolve().then(c),d&&s(c);else if(l.onReadyBeingFired)l.onReadyBeingFired.push(c),d&&s(c);else{s(c);var y=r;d||s(function E(){y.on.ready.unsubscribe(c),y.on.ready.unsubscribe(E)})}})}}),this.Collection=Hi(this),this.Table=zi(this),this.Transaction=ea(this),this.Version=ya(this),this.WhereClause=Zi(this),this.on("versionchange",function(s){s.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})}),this.on("blocked",function(s){!s.newVersion||s.newVersion<s.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(s.oldVersion/10))}),this._maxKey=at(n.IDBKeyRange),this._createTransaction=function(s,c,d,l){return new r.Transaction(s,c,d,r._options.chromeTransactionDurability,l)},this._fireOnBlocked=function(s){r.on("blocked").fire(s),$e.filter(function(c){return c.name===r.name&&c!==r&&!c._state.vcFired}).map(function(c){return c.on("versionchange").fire(s)})},this.use(Pa),this.use(ja),this.use(Ca),this.use(Ea),this.use(Ia);var u=new Proxy(this,{get:function(s,c,d){if(c==="_vip")return!0;if(c==="table")return function(y){return Bt(r.table(y),u)};var l=Reflect.get(s,c,d);return l instanceof wr?Bt(l,u):c==="tables"?l.map(function(y){return Bt(y,u)}):c==="_createTransaction"?function(){var y=l.apply(this,arguments);return Bt(y,u)}:l}});this.vip=u,a.forEach(function(s){return s(r)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new K.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new K.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var n=this._versions,r=n.filter(function(i){return i._cfg.version===t})[0];return r||(r=new this.Version(t),n.push(r),n.sort(ua),r.stores({}),this._state.autoSchema=!1,r)},e.prototype._whenReady=function(t){var n=this;return this.idbdb&&(this._state.openComplete||O.letThrough||this._vip)?t():new S(function(r,i){if(n._state.openComplete)return i(new K.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._state.autoOpen){i(new K.DatabaseClosed);return}n.open().catch(W)}n._state.dbReadyPromise.then(r,i)}).then(t)},e.prototype.use=function(t){var n=t.stack,r=t.create,i=t.level,a=t.name;a&&this.unuse({stack:n,name:a});var o=this._middlewares[n]||(this._middlewares[n]=[]);return o.push({stack:n,create:r,level:i??10,name:a}),o.sort(function(u,s){return u.level-s.level}),this},e.prototype.unuse=function(t){var n=t.stack,r=t.name,i=t.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(a){return i?a.create!==i:r?a.name!==r:!1})),this},e.prototype.open=function(){var t=this;return Ae(ve,function(){return xa(t)})},e.prototype._close=function(){var t=this._state,n=$e.indexOf(this);if(n>=0&&$e.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}t.isBeingOpened||(t.dbReadyPromise=new S(function(r){t.dbReadyResolve=r}),t.openCanceller=new S(function(r,i){t.cancelOpen=i}))},e.prototype.close=function(t){var n=t===void 0?{disableAutoOpen:!0}:t,r=n.disableAutoOpen,i=this._state;r?(i.isBeingOpened&&i.cancelOpen(new K.DatabaseClosed),this._close(),i.autoOpen=!1,i.dbOpenError=new K.DatabaseClosed):(this._close(),i.autoOpen=this._options.autoOpen||i.isBeingOpened,i.openComplete=!1,i.dbOpenError=null)},e.prototype.delete=function(t){var n=this;t===void 0&&(t={disableAutoOpen:!0});var r=arguments.length>0&&typeof arguments[0]!="object",i=this._state;return new S(function(a,o){var u=function(){n.close(t);var s=n._deps.indexedDB.deleteDatabase(n.name);s.onsuccess=Y(function(){ba(n._deps,n.name),a()}),s.onerror=se(o),s.onblocked=n._fireOnBlocked};if(r)throw new K.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(u):u()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return N(this._allTables).map(function(n){return t._allTables[n]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=_a.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,n,r){var i=this,a=O.trans;(!a||a.db!==this||t.indexOf("!")!==-1)&&(a=null);var o=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var u,s;try{if(s=n.map(function(d){var l=d instanceof i.Table?d.name:d;if(typeof l!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return l}),t=="r"||t===dn)u=dn;else if(t=="rw"||t==pn)u=pn;else throw new K.InvalidArgument("Invalid transaction mode: "+t);if(a){if(a.mode===dn&&u===pn)if(o)a=null;else throw new K.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a&&s.forEach(function(d){if(a&&a.storeNames.indexOf(d)===-1)if(o)a=null;else throw new K.SubTransaction("Table "+d+" not included in parent transaction.")}),o&&a&&!a.active&&(a=null)}}catch(d){return a?a._promise(null,function(l,y){y(d)}):G(d)}var c=Kr.bind(null,this,u,s,a,r);return a?a._promise(u,c,"lock"):O.trans?Ae(O.transless,function(){return i._whenReady(c)}):this._whenReady(c)},e.prototype.table=function(t){if(!$(this._allTables,t))throw new K.InvalidTable("Table ".concat(t," does not exist"));return this._allTables[t]},e}(),Na=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",La=function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,n,r){return this._subscribe(!t||typeof t=="function"?{next:t,error:n,complete:r}:t)},e.prototype[Na]=function(){return this},e}(),Ft;try{Ft={indexedDB:D.indexedDB||D.mozIndexedDB||D.webkitIndexedDB||D.msIndexedDB,IDBKeyRange:D.IDBKeyRange||D.webkitIDBKeyRange}}catch{Ft={indexedDB:null,IDBKeyRange:null}}function Lr(e){var t=!1,n,r=new La(function(i){var a=Jt(e);function o(g){var w=Le();try{a&&ze();var _=ye(e,g);return a&&(_=_.finally(me)),_}finally{w&&Ve()}}var u=!1,s,c={},d={},l={get closed(){return u},unsubscribe:function(){u||(u=!0,s&&s.abort(),y&&we.storagemutated.unsubscribe(p))}};i.start&&i.start(l);var y=!1,E=function(){return ln(m)};function f(){return An(d,c)}var p=function(g){Kt(c,g),f()&&E()},m=function(){if(!(u||!Ft.indexedDB)){c={};var g={};s&&s.abort(),s=new AbortController;var w={subscr:g,signal:s.signal,requery:E,querier:e,trans:null},_=o(w);Promise.resolve(_).then(function(k){t=!0,n=k,!(u||w.signal.aborted)&&(c={},d=g,!yi(d)&&!y&&(we(it,p),y=!0),ln(function(){return!u&&i.next&&i.next(k)}))},function(k){t=!1,["DatabaseClosedError","AbortError"].includes(k?.name)||u||ln(function(){u||i.error&&i.error(k)})})}};return setTimeout(E,0),l});return r.hasValue=function(){return t},r.getValue=function(){return n},r}var Re=pe;Z(Re,b(b({},dt),{delete:function(e){var t=new Re(e,{addons:[]});return t.delete()},exists:function(e){return new Re(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return ma(Re.dependencies).then(e)}catch{return G(new K.MissingAPI)}},defineClass:function(){function e(t){L(this,t)}return e},ignoreTransaction:function(e){return O.trans?Ae(O.transless,e):e()},vip:Pn,async:function(e){return function(){try{var t=Rn(e.apply(this,arguments));return!t||typeof t.then!="function"?S.resolve(t):t}catch(n){return G(n)}}},spawn:function(e,t,n){try{var r=Rn(e.apply(n,t||[]));return!r||typeof r.then!="function"?S.resolve(r):r}catch(i){return G(i)}},currentTransaction:{get:function(){return O.trans||null}},waitFor:function(e,t){var n=S.resolve(typeof e=="function"?Re.ignoreTransaction(e):e).timeout(t||6e4);return O.trans?O.trans.waitFor(n):n},Promise:S,debug:{get:function(){return ue},set:function(e){ar(e)}},derive:Be,extend:L,props:Z,override:Xn,Events:et,on:we,liveQuery:Lr,extendObservabilitySet:Kt,getByKeyPath:fe,setByKeyPath:ne,delByKeyPath:di,shallowClone:Zn,deepClone:Ie,getObjectDiff:Mn,cmp:z,asap:Jn,minKey:hn,addons:[],connections:$e,errnames:qt,dependencies:Ft,cache:Ke,semVer:pr,version:pr.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,n*2)})})),Re.maxKey=at(Re.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(we(it,function(e){if(!xe){var t;t=new CustomEvent(gn,{detail:e}),xe=!0,dispatchEvent(t),xe=!1}}),addEventListener(gn,function(e){var t=e.detail;xe||jn(t)}));function jn(e){var t=xe;try{xe=!0,we.storagemutated.fire(e),Kn(e,!0)}finally{xe=t}}var xe=!1,_e,Nn=function(){};typeof BroadcastChannel<"u"&&(Nn=function(){_e=new BroadcastChannel(gn),_e.onmessage=function(e){return e.data&&jn(e.data)}},Nn(),typeof _e.unref=="function"&&_e.unref(),we(it,function(e){xe||_e.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!pe.disableBfCache&&e.persisted){ue&&console.debug("Dexie: handling persisted pagehide"),_e?.close();for(var t=0,n=$e;t<n.length;t++){var r=n[t];r.close({disableAutoOpen:!1})}}}),addEventListener("pageshow",function(e){!pe.disableBfCache&&e.persisted&&(ue&&console.debug("Dexie: handling persisted pageshow"),Nn(),jn({all:new ee(-1/0,[[]])}))}));function Va(e){return new nt({add:e})}function za(e){return new nt({remove:e})}function $a(e,t){return new nt({replacePrefix:[e,t]})}S.rejectionMapper=_i,ar(ue);var Wa=Object.freeze({__proto__:null,Dexie:pe,liveQuery:Lr,Entity:mr,cmp:z,PropModSymbol:Wi,PropModification:nt,replacePrefix:$a,add:Va,remove:za,default:pe,RangeSet:ee,mergeRanges:st,rangesOverlap:Tr});return b(pe,Wa,{default:pe}),pe})});var $r=Symbol("Comlink.proxy"),eo=Symbol("Comlink.endpoint"),to=Symbol("Comlink.releaseProxy"),Ln=Symbol("Comlink.finalizer"),Lt=Symbol("Comlink.thrown"),Wr=h=>typeof h=="object"&&h!==null||typeof h=="function",no={canHandle:h=>Wr(h)&&h[$r],serialize(h){let{port1:v,port2:b}=new MessageChannel;return Wt(h,v),[b,[b]]},deserialize(h){return h.start(),oo(h)}},ro={canHandle:h=>Wr(h)&&Lt in h,serialize({value:h}){let v;return h instanceof Error?v={isError:!0,value:{message:h.message,name:h.name,stack:h.stack}}:v={isError:!1,value:h},[v,[]]},deserialize(h){throw h.isError?Object.assign(new Error(h.value.message),h.value):h.value}},Qr=new Map([["proxy",no],["throw",ro]]);function io(h,v){for(let b of h)if(v===b||b==="*"||b instanceof RegExp&&b.test(v))return!0;return!1}function Wt(h,v=globalThis,b=["*"]){v.addEventListener("message",function C(D){if(!D||!D.data)return;if(!io(b,D.origin)){console.warn(`Invalid origin '${D.origin}' for comlink proxy`);return}let{id:N,type:j,path:L}=Object.assign({path:[]},D.data),U=(D.data.argumentList||[]).map(Me),H;try{let $=L.slice(0,-1).reduce((q,te)=>q[te],h),Z=L.reduce((q,te)=>q[te],h);switch(j){case"GET":H=Z;break;case"SET":$[L.slice(-1)[0]]=Me(D.data.value),H=!0;break;case"APPLY":H=Z.apply($,U);break;case"CONSTRUCT":{let q=new Z(...U);H=fo(q)}break;case"ENDPOINT":{let{port1:q,port2:te}=new MessageChannel;Wt(h,te),H=lo(q,[q])}break;case"RELEASE":H=void 0;break;default:return}}catch($){H={value:$,[Lt]:0}}Promise.resolve(H).catch($=>({value:$,[Lt]:0})).then($=>{let[Z,q]=$t($);v.postMessage(Object.assign(Object.assign({},Z),{id:N}),q),j==="RELEASE"&&(v.removeEventListener("message",C),Hr(v),Ln in h&&typeof h[Ln]=="function"&&h[Ln]())}).catch($=>{let[Z,q]=$t({value:new TypeError("Unserializable return value"),[Lt]:0});v.postMessage(Object.assign(Object.assign({},Z),{id:N}),q)})}),v.start&&v.start()}function ao(h){return h.constructor.name==="MessagePort"}function Hr(h){ao(h)&&h.close()}function oo(h,v){return Vn(h,[],v)}function Nt(h){if(h)throw new Error("Proxy has been released and is not useable")}function Yr(h){return He(h,{type:"RELEASE"}).then(()=>{Hr(h)})}var Vt=new WeakMap,zt="FinalizationRegistry"in globalThis&&new FinalizationRegistry(h=>{let v=(Vt.get(h)||0)-1;Vt.set(h,v),v===0&&Yr(h)});function uo(h,v){let b=(Vt.get(v)||0)+1;Vt.set(v,b),zt&&zt.register(h,v,h)}function so(h){zt&&zt.unregister(h)}function Vn(h,v=[],b=function(){}){let C=!1,D=new Proxy(b,{get(N,j){if(Nt(C),j===to)return()=>{so(D),Yr(h),C=!0};if(j==="then"){if(v.length===0)return{then:()=>D};let L=He(h,{type:"GET",path:v.map(U=>U.toString())}).then(Me);return L.then.bind(L)}return Vn(h,[...v,j])},set(N,j,L){Nt(C);let[U,H]=$t(L);return He(h,{type:"SET",path:[...v,j].map($=>$.toString()),value:U},H).then(Me)},apply(N,j,L){Nt(C);let U=v[v.length-1];if(U===eo)return He(h,{type:"ENDPOINT"}).then(Me);if(U==="bind")return Vn(h,v.slice(0,-1));let[H,$]=zr(L);return He(h,{type:"APPLY",path:v.map(Z=>Z.toString()),argumentList:H},$).then(Me)},construct(N,j){Nt(C);let[L,U]=zr(j);return He(h,{type:"CONSTRUCT",path:v.map(H=>H.toString()),argumentList:L},U).then(Me)}});return uo(D,h),D}function co(h){return Array.prototype.concat.apply([],h)}function zr(h){let v=h.map($t);return[v.map(b=>b[0]),co(v.map(b=>b[1]))]}var Ur=new WeakMap;function lo(h,v){return Ur.set(h,v),h}function fo(h){return Object.assign(h,{[$r]:!0})}function $t(h){for(let[v,b]of Qr)if(b.canHandle(h)){let[C,D]=b.serialize(h);return[{type:"HANDLER",name:v,value:C},D]}return[{type:"RAW",value:h},Ur.get(h)||[]]}function Me(h){switch(h.type){case"HANDLER":return Qr.get(h.name).deserialize(h.value);case"RAW":return h.value}}function He(h,v,b){return new Promise(C=>{let D=ho();h.addEventListener("message",function N(j){!j.data||!j.data.id||j.data.id!==D||(h.removeEventListener("message",N),C(j.data))}),h.start&&h.start(),h.postMessage(Object.assign({id:D},v),b)})}function ho(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var vo=Math.pow(10,8)*24*60*60*1e3,Ko=-vo;var yo=3600;var Gr=yo*24,Ro=Gr*7,mo=Gr*365.2425,go=mo/12,Mo=go*3,zn=Symbol.for("constructDateFrom");function Qt(h,v){return typeof h=="function"?h(v):h&&typeof h=="object"&&zn in h?h[zn](v):h instanceof Date?new h.constructor(v):new Date(v)}function lt(h,v){return Qt(v||h,h)}function Xr(h,v,b){let C=lt(h,b?.in);return isNaN(v)?Qt(b?.in||h,NaN):(v&&C.setDate(C.getDate()+v),C)}function Jr(h,v){return+lt(h)>+lt(v)}var Ht=qa(Zr(),1),qr=Symbol.for("Dexie"),Yt=globalThis[qr]||(globalThis[qr]=Ht.default);if(Ht.default.semVer!==Yt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Ht.default.semVer} and ${Yt.semVer}`);var{liveQuery:Ho,mergeRanges:Yo,rangesOverlap:Uo,RangeSet:Go,cmp:Xo,Entity:Jo,PropModSymbol:Zo,PropModification:qo,replacePrefix:eu,add:tu,remove:nu}=Yt;var ei=Yt;var Qn=class extends ei{keyValue;packageIndex;symbolIndex;constructor(){super("CacheStore"),this.version(2).stores({keyValue:"key",packageIndex:"importPath, prefix, name",symbolIndex:`
        key,
        packagePath,
        [packageName+prefix],
        [packageName+label],
        [packagePath+prefix]`})}},Hn=class{constructor(v){this.db=v}async getItem(v,b){let C=await this.db.keyValue.get(v);if(C?.expireAt&&Jr(new Date,C.expireAt)){this.deleteItem(v);return}if(C&&b&&!b(C)){this.deleteItem(v);return}return C?.value}async deleteItem(v){return await this.db.keyValue.where({key:v}).delete()>0}async setItem(v,b,C){await this.deleteItem(v),await this.db.keyValue.put({key:v,value:b,expireAt:C})}async flush(){await this.db.keyValue.clear()}},Yn=new Qn,ti=new Hn(Yn);var ni="completionItems.version",bo=7,wo=()=>Xr(new Date,bo),xo=h=>"packageName"in h,Un=class{cachePopulated=!1;populatePromise;db=Yn;keyValue=ti;isWarmUp(){return this.cachePopulated}async getBuiltinNames(){return await this.checkCacheReady(),(await this.db.symbolIndex.where({packageName:"builtin"}).toArray()).map(({label:b})=>b)}buildHoverFilter(v){if(!("packageName"in v))return{key:`builtin.${v.value}`};let C=ii(v.context,v.packageName);return C?{key:`${C}.${v.value}`}:{packageName:v.packageName,label:v.value}}async getHoverValue(v){await this.checkCacheReady();let b=this.buildHoverFilter(v),C=await this.db.symbolIndex.where(b).first();return C?{contents:Do(C),range:v.context.range}:null}async getImportSuggestions(){return await this.getStandardPackages()}async getSymbolSuggestions(v){return console.log(v),await this.checkCacheReady(),xo(v)?await this.getMemberSuggestion(v):await this.getLiteralSuggestion(v)}async getMemberSuggestion({value:v,packageName:b,context:C}){let D=ii(C,b),N=D?{packagePath:D}:{packageName:b};return v&&(N.prefix=v.charAt(0).toLowerCase()),(await this.db.symbolIndex.where(N).toArray()).map(L=>ri(L,C,!!D))}async getLiteralSuggestion({value:v,context:b}){let C=await this.db.packageIndex.where("prefix").equals(v).toArray(),D=await this.db.symbolIndex.where("packagePath").equals("builtin").toArray(),N=C.map(L=>To(L,b)),j=D.map(L=>ri(L,b,!1));return N.concat(j)}async getStandardPackages(){return await this.checkCacheReady(),(await this.db.packageIndex.toArray()).map(Co)}async checkCacheReady(){if(this.cachePopulated)return!0;if(!await this.keyValue.getItem(ni,C=>typeof C.expireAt<"u"))return await this.populateCache(),!0;let b=await this.db.packageIndex.count();return this.cachePopulated=b>0,this.cachePopulated||await this.populateCache(),this.cachePopulated}async populateCache(){this.populatePromise||(this.populatePromise=(async()=>{let v=await fetch("/static/go-index.json");if(!v.ok)throw new Error(`${v.status} ${v.statusText}`);let b=await v.json();if(b.version>1){console.warn(`unsupported symbol index version: ${b.version}, skip update.`);return}console.log(b);let C=So(b.packages),D=Po(b.symbols);await Promise.all([this.db.packageIndex.clear(),this.db.symbolIndex.clear(),this.db.packageIndex.bulkAdd(C),this.db.symbolIndex.bulkAdd(D),this.keyValue.setItem(ni,b.go,wo())]),this.cachePopulated=!0})()),await this.populatePromise}};Wt(new Un);var _o=(b=>(b[b.Name=0]="Name",b[b.Path=1]="Path",b))(_o||{}),ko=(C=>(C[C.None=0]="None",C[C.Single=1]="Single",C[C.Block=2]="Block",C))(ko||{}),oi=h=>h[0]?.toLowerCase()??"",Eo=void 0,ui=8,Io=(h,v)=>h.length?h:v,si=h=>{if(h.length)return{value:h,isTrusted:!0}},So=({names:h,paths:v,docs:b})=>h.map((C,D)=>({name:C,importPath:v[D],prefix:oi(h[D]),documentation:si(b[D])})),Po=({names:h,docs:v,details:b,signatures:C,insertTexts:D,insertTextRules:N,kinds:j,packages:L})=>h.map((U,H)=>({key:`${L[H][1]}.${U}`,label:U,detail:Io(b[H],U),signature:C[H],kind:j[H],insertText:D[H],insertTextRules:N[H],prefix:oi(U),packageName:L[H][0],packagePath:L[H][1],documentation:si(v[H])})),Co=({importPath:h,name:v,documentation:b})=>({label:h,documentation:b,detail:v,insertText:h,kind:ui,range:Eo}),ci=(h,{imports:v})=>{if(!(!v.range||v.allPaths?.has(h)))switch(v.blockType){case 0:{let b=`import "${h}"
`;return[{text:v.prependNewLine?`
${b}`:b,range:v.range,forceMoveMarkers:!0}]}case 1:case 2:return[{text:`import (
${(v.blockPaths??[]).concat(h).sort().map(C=>`	"${C}"`).join(`
`)}
)`,range:v.range,forceMoveMarkers:!0}]}},To=({importPath:h,name:v,documentation:b},C)=>({label:v,documentation:b,detail:h,insertText:v,kind:ui,range:C.range,additionalTextEdits:ci(h,C)}),ri=({packagePath:h,...v},b,C)=>({...v,range:b.range,additionalTextEdits:C?ci(h,b):void 0}),Ao=h=>{let v=h.lastIndexOf("/");return v===-1?h:h.slice(v+1)},ii=({imports:h},v)=>{if(h.allPaths){if(h.allPaths.has(v))return v;for(let b of h.allPaths.keys())if(v===Ao(b))return b}},ai="pkg.go.dev",Do=({label:h,packageName:v,packagePath:b,signature:C,documentation:D})=>{let N=[];C&&N.push({value:"```go\n"+C+"\n```"}),D&&N.push(D);let L=`\`${b==="builtin"?h:`${v}.${h}`}\` on ${ai}`;return N.push({value:`[${L}](https://${ai}/${b}#${h})`,isTrusted:!0}),N};export{ko as ImportClauseType,_o as SymbolSourceKey,Un as WorkerHandler,To as completionFromPackage,ri as completionFromSymbol,So as constructPackages,Po as constructSymbols,ii as findPackagePathFromContext,Co as importCompletionFromPackage,Do as symbolHoverDoc};
/*! Bundled license information:

dexie/dist/dexie.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

comlink/dist/esm/comlink.mjs:
  (**
   * @license
   * Copyright 2019 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   *)
*/
