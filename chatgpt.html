<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chat Service</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">
<div class="container mx-auto py-6">
    <div class="flex">
        <div class="w-1/4 bg-white p-4 rounded-lg shadow">
            <h2 class="text-xl font-bold mb-4">Previous Chats</h2>
            <ul id="chat-list">
                {{range .Chats}}
                    <li class="mb-2"><a href="/llm/{{.ID}}" class="text-blue-500">{{.Name}}</a></li>
                {{end}}
            </ul>
        </div>
        <div class="w-3/4 bg-white p-4 rounded-lg shadow ml-4">
            <div id="chat-window" class="h-96 overflow-y-auto mb-4">
                {{range .Messages}}
                    <div class="{{if eq .Role "user"}}text-right{{else}}text-left{{end}} mb-2">
                        <div class="inline-block px-4 py-2 {{if eq .Role "user"}}bg-blue-500 text-white{{else}}bg-gray-300 text-black{{end}} rounded">
                            {{.Content}}
                        </div>
                    </div>
                {{end}}
            </div>
            <form id="chat-form" hx-post="/llm/send" hx-target="#chat-window" hx-swap="innerHTML">
                <input type="text" name="message" class="w-full p-2 border rounded" placeholder="Type a message...">
                <button type="submit" class="mt-2 bg-blue-500 text-white p-2 rounded">Send</button>
            </form>
        </div>
    </div>
</div>
<script src="https://unpkg.com/htmx.org@2.0.0"></script>
<script>
    htmx.defineExtension('catch', {
        onEvent: function (name, evt) {
            // interested only in errors
            if(evt.detail?.errorInfo?.error) {
                // the general 'htmx:error' event
                console.log({
                    type:evt.type,
                    info: evt.detail.errorInfo?.error
                });
            }
            if(evt.detail?.error) {
                // the specific event, e.g. 'htmx:responseError'
                console.log({
                    type: evt.type,
                    info: evt.detail.error
                });
            }
        }
    });
</script>
</body>
</html>
